Saving pipeline log to: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/logs/pipeline.log

==================================================
Running Stage 0: Data Generation
==================================================
Using 12 worker processes for data generation.
Generating train set...

Generating train:   0%|          | 0/1800 [00:00<?, ?it/s]
Generating train:   0%|          | 1/1800 [00:02<1:23:38,  2.79s/it]
Generating train:   1%|          | 12/1800 [00:03<06:08,  4.85it/s] 
Generating train:   1%|          | 14/1800 [00:03<06:05,  4.89it/s]
Generating train:   1%|▏         | 25/1800 [00:04<03:04,  9.64it/s]
Generating train:   2%|▏         | 36/1800 [00:04<01:48, 16.20it/s]
Generating train:   2%|▏         | 40/1800 [00:04<02:20, 12.50it/s]
Generating train:   3%|▎         | 48/1800 [00:04<01:41, 17.21it/s]
Generating train:   3%|▎         | 52/1800 [00:05<02:08, 13.63it/s]
Generating train:   3%|▎         | 60/1800 [00:05<01:29, 19.52it/s]
Generating train:   4%|▎         | 65/1800 [00:06<01:58, 14.63it/s]
Generating train:   4%|▍         | 73/1800 [00:06<01:54, 15.03it/s]
Generating train:   5%|▍         | 85/1800 [00:07<01:46, 16.05it/s]
Generating train:   5%|▌         | 97/1800 [00:07<01:14, 22.80it/s]
Generating train:   6%|▌         | 101/1800 [00:08<01:39, 17.14it/s]
Generating train:   6%|▌         | 109/1800 [00:08<01:41, 16.66it/s]
Generating train:   6%|▋         | 113/1800 [00:08<01:38, 17.14it/s]
Generating train:   7%|▋         | 121/1800 [00:09<01:33, 17.87it/s]
Generating train:   7%|▋         | 124/1800 [00:09<01:33, 18.02it/s]
Generating train:   7%|▋         | 128/1800 [00:09<01:27, 19.08it/s]
Generating train:   7%|▋         | 133/1800 [00:09<01:24, 19.68it/s]
Generating train:   8%|▊         | 136/1800 [00:10<01:31, 18.25it/s]
Generating train:   8%|▊         | 140/1800 [00:10<01:26, 19.16it/s]
Generating train:   8%|▊         | 145/1800 [00:10<01:21, 20.23it/s]
Generating train:   8%|▊         | 148/1800 [00:10<01:39, 16.58it/s]
Generating train:   8%|▊         | 152/1800 [00:11<01:45, 15.66it/s]
Generating train:   9%|▉         | 159/1800 [00:11<01:14, 22.02it/s]
Generating train:   9%|▉         | 162/1800 [00:11<01:31, 18.00it/s]
Generating train:   9%|▉         | 165/1800 [00:11<01:31, 17.88it/s]
Generating train:  10%|▉         | 171/1800 [00:11<01:08, 23.73it/s]
Generating train:  10%|▉         | 174/1800 [00:12<01:30, 17.88it/s]
Generating train:  10%|▉         | 177/1800 [00:12<01:32, 17.52it/s]
Generating train:  10%|█         | 183/1800 [00:12<01:17, 20.85it/s]
Generating train:  10%|█         | 186/1800 [00:12<02:02, 13.12it/s]
Generating train:  11%|█         | 196/1800 [00:13<01:15, 21.17it/s]
Generating train:  11%|█         | 199/1800 [00:13<01:49, 14.67it/s]
Generating train:  12%|█▏        | 208/1800 [00:13<01:09, 22.88it/s]
Generating train:  12%|█▏        | 212/1800 [00:14<01:41, 15.61it/s]
Generating train:  12%|█▏        | 220/1800 [00:14<01:12, 21.87it/s]
Generating train:  12%|█▏        | 224/1800 [00:14<01:34, 16.67it/s]
Generating train:  13%|█▎        | 232/1800 [00:15<01:09, 22.70it/s]
Generating train:  13%|█▎        | 236/1800 [00:15<01:41, 15.37it/s]
Generating train:  14%|█▎        | 245/1800 [00:16<01:38, 15.75it/s]
Generating train:  14%|█▍        | 248/1800 [00:16<01:40, 15.42it/s]
Generating train:  14%|█▍        | 257/1800 [00:16<01:33, 16.55it/s]
Generating train:  14%|█▍        | 260/1800 [00:17<01:42, 14.99it/s]
Generating train:  15%|█▍        | 269/1800 [00:17<01:33, 16.45it/s]
Generating train:  15%|█▌        | 271/1800 [00:17<01:34, 16.13it/s]
Generating train:  16%|█▌        | 281/1800 [00:17<01:05, 23.33it/s]
Generating train:  16%|█▌        | 284/1800 [00:18<01:25, 17.72it/s]
Generating train:  16%|█▋        | 293/1800 [00:18<01:10, 21.28it/s]
Generating train:  16%|█▋        | 296/1800 [00:19<01:30, 16.55it/s]
Generating train:  17%|█▋        | 305/1800 [00:19<01:09, 21.64it/s]
Generating train:  17%|█▋        | 308/1800 [00:19<01:28, 16.87it/s]
Generating train:  18%|█▊        | 318/1800 [00:20<01:28, 16.69it/s]
Generating train:  18%|█▊        | 324/1800 [00:20<01:10, 20.79it/s]
Generating train:  18%|█▊        | 329/1800 [00:20<01:27, 16.72it/s]
Generating train:  19%|█▉        | 341/1800 [00:21<01:00, 24.14it/s]
Generating train:  19%|█▉        | 345/1800 [00:21<01:19, 18.32it/s]
Generating train:  20%|█▉        | 353/1800 [00:22<01:23, 17.31it/s]
Generating train:  20%|█▉        | 356/1800 [00:22<01:19, 18.14it/s]
Generating train:  20%|█▉        | 359/1800 [00:22<01:21, 17.68it/s]
Generating train:  20%|██        | 365/1800 [00:22<01:24, 17.08it/s]
Generating train:  20%|██        | 367/1800 [00:22<01:22, 17.40it/s]
Generating train:  21%|██        | 370/1800 [00:23<01:22, 17.38it/s]
Generating train:  21%|██        | 377/1800 [00:23<01:25, 16.64it/s]
Generating train:  21%|██        | 382/1800 [00:23<01:11, 19.93it/s]
Generating train:  21%|██▏       | 385/1800 [00:23<01:06, 21.32it/s]
Generating train:  22%|██▏       | 389/1800 [00:24<01:34, 15.01it/s]
Generating train:  22%|██▏       | 401/1800 [00:24<01:14, 18.66it/s]
Generating train:  22%|██▏       | 404/1800 [00:24<01:21, 17.21it/s]
Generating train:  23%|██▎       | 413/1800 [00:25<01:08, 20.14it/s]
Generating train:  23%|██▎       | 416/1800 [00:25<01:07, 20.60it/s]
Generating train:  24%|██▎       | 425/1800 [00:25<00:47, 28.81it/s]
Generating train:  24%|██▍       | 429/1800 [00:26<01:14, 18.52it/s]
Generating train:  24%|██▍       | 438/1800 [00:26<01:24, 16.11it/s]
Generating train:  25%|██▍       | 448/1800 [00:26<01:04, 21.11it/s]
Generating train:  25%|██▌       | 451/1800 [00:27<01:19, 16.95it/s]
Generating train:  26%|██▌       | 461/1800 [00:27<01:10, 19.13it/s]
Generating train:  26%|██▌       | 464/1800 [00:28<01:18, 16.97it/s]
Generating train:  26%|██▋       | 473/1800 [00:28<01:09, 19.03it/s]
Generating train:  26%|██▋       | 476/1800 [00:28<01:21, 16.25it/s]
Generating train:  27%|██▋       | 485/1800 [00:29<01:06, 19.83it/s]
Generating train:  27%|██▋       | 488/1800 [00:29<01:19, 16.54it/s]
Generating train:  28%|██▊       | 497/1800 [00:29<01:00, 21.59it/s]
Generating train:  28%|██▊       | 500/1800 [00:29<01:16, 17.10it/s]
Generating train:  28%|██▊       | 509/1800 [00:30<01:03, 20.20it/s]
Generating train:  28%|██▊       | 512/1800 [00:30<01:31, 14.07it/s]
Generating train:  29%|██▉       | 522/1800 [00:31<01:13, 17.29it/s]
Generating train:  30%|██▉       | 533/1800 [00:31<00:51, 24.78it/s]
Generating train:  30%|██▉       | 537/1800 [00:32<01:13, 17.08it/s]
Generating train:  30%|███       | 546/1800 [00:32<01:09, 18.13it/s]
Generating train:  30%|███       | 549/1800 [00:32<01:11, 17.45it/s]
Generating train:  31%|███       | 557/1800 [00:32<00:55, 22.29it/s]
Generating train:  31%|███       | 560/1800 [00:33<01:17, 15.96it/s]
Generating train:  32%|███▏      | 569/1800 [00:33<00:52, 23.23it/s]
Generating train:  32%|███▏      | 573/1800 [00:33<01:09, 17.69it/s]
Generating train:  32%|███▏      | 576/1800 [00:34<01:06, 18.35it/s]
Generating train:  32%|███▏      | 581/1800 [00:34<00:56, 21.51it/s]
Generating train:  32%|███▏      | 584/1800 [00:34<01:18, 15.49it/s]
Generating train:  33%|███▎      | 593/1800 [00:35<01:11, 16.83it/s]
Generating train:  33%|███▎      | 596/1800 [00:35<01:14, 16.17it/s]
Generating train:  34%|███▎      | 605/1800 [00:35<01:09, 17.29it/s]
Generating train:  34%|███▎      | 607/1800 [00:35<01:14, 15.99it/s]
Generating train:  34%|███▍      | 617/1800 [00:36<00:58, 20.21it/s]
Generating train:  34%|███▍      | 620/1800 [00:36<01:08, 17.29it/s]
Generating train:  35%|███▍      | 629/1800 [00:36<00:59, 19.60it/s]
Generating train:  35%|███▌      | 631/1800 [00:37<01:08, 17.01it/s]
Generating train:  36%|███▌      | 640/1800 [00:37<00:45, 25.65it/s]
Generating train:  36%|███▌      | 644/1800 [00:37<01:05, 17.73it/s]
Generating train:  36%|███▋      | 653/1800 [00:38<01:02, 18.29it/s]
Generating train:  36%|███▋      | 656/1800 [00:38<01:06, 17.25it/s]
Generating train:  37%|███▋      | 665/1800 [00:38<00:57, 19.84it/s]
Generating train:  37%|███▋      | 668/1800 [00:39<01:07, 16.66it/s]
Generating train:  38%|███▊      | 677/1800 [00:39<00:53, 21.13it/s]
Generating train:  38%|███▊      | 680/1800 [00:39<01:10, 15.98it/s]
Generating train:  38%|███▊      | 689/1800 [00:40<00:51, 21.52it/s]
Generating train:  38%|███▊      | 692/1800 [00:40<01:26, 12.86it/s]
Generating train:  39%|███▉      | 702/1800 [00:41<01:06, 16.52it/s]
Generating train:  39%|███▉      | 705/1800 [00:41<01:11, 15.24it/s]
Generating train:  40%|███▉      | 715/1800 [00:41<01:04, 16.92it/s]
Generating train:  40%|████      | 726/1800 [00:42<00:46, 22.88it/s]
Generating train:  40%|████      | 729/1800 [00:42<01:08, 15.73it/s]
Generating train:  41%|████      | 739/1800 [00:43<01:04, 16.50it/s]
Generating train:  42%|████▏     | 750/1800 [00:43<00:47, 21.91it/s]
Generating train:  42%|████▏     | 753/1800 [00:43<00:59, 17.59it/s]
Generating train:  42%|████▏     | 762/1800 [00:44<00:47, 21.65it/s]
Generating train:  42%|████▎     | 765/1800 [00:44<01:01, 16.96it/s]
Generating train:  43%|████▎     | 774/1800 [00:44<00:45, 22.67it/s]
Generating train:  43%|████▎     | 777/1800 [00:45<01:00, 16.96it/s]
Generating train:  44%|████▎     | 786/1800 [00:45<00:44, 22.87it/s]
Generating train:  44%|████▍     | 790/1800 [00:45<00:56, 17.74it/s]
Generating train:  44%|████▍     | 798/1800 [00:46<00:50, 19.84it/s]
Generating train:  44%|████▍     | 801/1800 [00:46<01:03, 15.82it/s]
Generating train:  45%|████▌     | 810/1800 [00:46<00:52, 18.68it/s]
Generating train:  45%|████▌     | 813/1800 [00:47<01:02, 15.70it/s]
Generating train:  46%|████▌     | 822/1800 [00:47<00:47, 20.58it/s]
Generating train:  46%|████▌     | 825/1800 [00:47<01:03, 15.41it/s]
Generating train:  46%|████▋     | 834/1800 [00:48<00:44, 21.69it/s]
Generating train:  46%|████▋     | 837/1800 [00:48<01:02, 15.52it/s]
Generating train:  47%|████▋     | 847/1800 [00:49<01:00, 15.79it/s]
Generating train:  47%|████▋     | 852/1800 [00:49<00:51, 18.50it/s]
Generating train:  48%|████▊     | 859/1800 [00:49<00:55, 16.89it/s]
Generating train:  48%|████▊     | 871/1800 [00:50<00:51, 17.99it/s]
Generating train:  49%|████▊     | 874/1800 [00:50<00:49, 18.84it/s]
Generating train:  49%|████▉     | 883/1800 [00:51<00:53, 17.09it/s]
Generating train:  50%|████▉     | 895/1800 [00:51<00:51, 17.49it/s]
Generating train:  50%|█████     | 900/1800 [00:51<00:44, 20.03it/s]
Generating train:  50%|█████     | 907/1800 [00:52<00:48, 18.30it/s]
Generating train:  51%|█████     | 912/1800 [00:52<00:44, 19.75it/s]
Generating train:  51%|█████     | 919/1800 [00:52<00:45, 19.27it/s]
Generating train:  51%|█████▏    | 924/1800 [00:53<00:43, 20.32it/s]
Generating train:  52%|█████▏    | 931/1800 [00:53<00:48, 18.02it/s]
Generating train:  52%|█████▏    | 936/1800 [00:53<00:41, 20.88it/s]
Generating train:  52%|█████▏    | 943/1800 [00:54<00:49, 17.41it/s]
Generating train:  53%|█████▎    | 948/1800 [00:54<00:41, 20.60it/s]
Generating train:  53%|█████▎    | 955/1800 [00:54<00:48, 17.59it/s]
Generating train:  53%|█████▎    | 960/1800 [00:55<00:44, 18.74it/s]
Generating train:  54%|█████▎    | 967/1800 [00:55<00:48, 17.23it/s]
Generating train:  54%|█████▍    | 979/1800 [00:56<00:42, 19.42it/s]
Generating train:  55%|█████▍    | 982/1800 [00:56<00:41, 19.82it/s]
Generating train:  55%|█████▌    | 991/1800 [00:56<00:43, 18.75it/s]
Generating train:  55%|█████▌    | 994/1800 [00:56<00:41, 19.64it/s]
Generating train:  56%|█████▌    | 1003/1800 [00:57<00:49, 16.15it/s]
Generating train:  56%|█████▋    | 1015/1800 [00:58<00:44, 17.46it/s]
Generating train:  57%|█████▋    | 1024/1800 [00:58<00:33, 22.83it/s]
Generating train:  57%|█████▋    | 1028/1800 [00:58<00:44, 17.35it/s]
Generating train:  58%|█████▊    | 1039/1800 [00:59<00:42, 17.80it/s]
Generating train:  58%|█████▊    | 1051/1800 [01:00<00:42, 17.71it/s]
Generating train:  59%|█████▊    | 1054/1800 [01:00<00:41, 17.90it/s]
Generating train:  59%|█████▉    | 1063/1800 [01:00<00:42, 17.54it/s]
Generating train:  60%|█████▉    | 1075/1800 [01:01<00:39, 18.31it/s]
Generating train:  60%|█████▉    | 1077/1800 [01:01<00:42, 17.04it/s]
Generating train:  60%|██████    | 1087/1800 [01:02<00:38, 18.41it/s]
Generating train:  60%|██████    | 1089/1800 [01:02<00:40, 17.61it/s]
Generating train:  61%|██████    | 1099/1800 [01:02<00:36, 19.25it/s]
Generating train:  61%|██████    | 1101/1800 [01:02<00:37, 18.74it/s]
Generating train:  62%|██████▏   | 1111/1800 [01:03<00:36, 18.77it/s]
Generating train:  62%|██████▏   | 1123/1800 [01:03<00:35, 19.14it/s]
Generating train:  62%|██████▎   | 1125/1800 [01:04<00:39, 16.98it/s]
Generating train:  63%|██████▎   | 1135/1800 [01:04<00:35, 18.73it/s]
Generating train:  63%|██████▎   | 1139/1800 [01:04<00:32, 20.64it/s]
Generating train:  64%|██████▎   | 1147/1800 [01:05<00:34, 18.96it/s]
Generating train:  64%|██████▍   | 1151/1800 [01:05<00:31, 20.57it/s]
Generating train:  64%|██████▍   | 1154/1800 [01:05<00:30, 21.42it/s]
Generating train:  64%|██████▍   | 1159/1800 [01:05<00:39, 16.36it/s]
Generating train:  65%|██████▌   | 1171/1800 [01:06<00:35, 17.48it/s]
Generating train:  66%|██████▌   | 1182/1800 [01:06<00:24, 24.86it/s]
Generating train:  66%|██████▌   | 1186/1800 [01:07<00:34, 17.65it/s]
Generating train:  66%|██████▌   | 1189/1800 [01:07<00:33, 18.47it/s]
Generating train:  66%|██████▋   | 1195/1800 [01:07<00:36, 16.36it/s]
Generating train:  67%|██████▋   | 1199/1800 [01:08<00:34, 17.46it/s]
Generating train:  67%|██████▋   | 1207/1800 [01:08<00:32, 18.15it/s]
Generating train:  67%|██████▋   | 1211/1800 [01:08<00:30, 19.32it/s]
Generating train:  68%|██████▊   | 1216/1800 [01:08<00:25, 23.07it/s]
Generating train:  68%|██████▊   | 1219/1800 [01:09<00:35, 16.46it/s]
Generating train:  68%|██████▊   | 1223/1800 [01:09<00:30, 18.94it/s]
Generating train:  68%|██████▊   | 1231/1800 [01:09<00:31, 17.97it/s]
Generating train:  69%|██████▊   | 1234/1800 [01:09<00:29, 19.40it/s]
Generating train:  69%|██████▊   | 1237/1800 [01:09<00:29, 19.08it/s]
Generating train:  69%|██████▉   | 1243/1800 [01:10<00:31, 17.41it/s]
Generating train:  69%|██████▉   | 1247/1800 [01:10<00:35, 15.69it/s]
Generating train:  70%|██████▉   | 1255/1800 [01:10<00:23, 22.96it/s]
Generating train:  70%|██████▉   | 1259/1800 [01:11<00:31, 17.30it/s]
Generating train:  70%|███████   | 1267/1800 [01:11<00:27, 19.54it/s]
Generating train:  71%|███████   | 1270/1800 [01:11<00:29, 17.86it/s]
Generating train:  71%|███████   | 1279/1800 [01:12<00:22, 22.72it/s]
Generating train:  71%|███████   | 1282/1800 [01:12<00:29, 17.44it/s]
Generating train:  72%|███████▏  | 1291/1800 [01:12<00:22, 22.59it/s]
Generating train:  72%|███████▏  | 1294/1800 [01:13<00:29, 17.25it/s]
Generating train:  72%|███████▏  | 1303/1800 [01:13<00:23, 21.00it/s]
Generating train:  73%|███████▎  | 1306/1800 [01:13<00:30, 16.44it/s]
Generating train:  73%|███████▎  | 1315/1800 [01:13<00:22, 21.93it/s]
Generating train:  73%|███████▎  | 1318/1800 [01:14<00:29, 16.60it/s]
Generating train:  73%|███████▎  | 1321/1800 [01:14<00:26, 18.12it/s]
Generating train:  74%|███████▎  | 1327/1800 [01:14<00:20, 23.09it/s]
Generating train:  74%|███████▍  | 1330/1800 [01:14<00:28, 16.70it/s]
Generating train:  74%|███████▍  | 1333/1800 [01:15<00:31, 14.85it/s]
Generating train:  74%|███████▍  | 1341/1800 [01:15<00:28, 16.30it/s]
Generating train:  75%|███████▍  | 1344/1800 [01:15<00:31, 14.62it/s]
Generating train:  75%|███████▌  | 1353/1800 [01:16<00:24, 17.99it/s]
Generating train:  75%|███████▌  | 1356/1800 [01:16<00:23, 18.63it/s]
Generating train:  76%|███████▌  | 1365/1800 [01:16<00:20, 20.84it/s]
Generating train:  76%|███████▌  | 1368/1800 [01:17<00:27, 15.74it/s]
Generating train:  76%|███████▋  | 1377/1800 [01:17<00:20, 21.06it/s]
Generating train:  77%|███████▋  | 1380/1800 [01:17<00:27, 15.47it/s]
Generating train:  77%|███████▋  | 1389/1800 [01:18<00:22, 18.03it/s]
Generating train:  77%|███████▋  | 1392/1800 [01:18<00:27, 14.88it/s]
Generating train:  78%|███████▊  | 1403/1800 [01:19<00:22, 17.72it/s]
Generating train:  78%|███████▊  | 1408/1800 [01:19<00:19, 20.05it/s]
Generating train:  78%|███████▊  | 1413/1800 [01:19<00:20, 19.13it/s]
Generating train:  79%|███████▊  | 1416/1800 [01:19<00:18, 20.27it/s]
Generating train:  79%|███████▉  | 1422/1800 [01:19<00:14, 25.83it/s]
Generating train:  79%|███████▉  | 1426/1800 [01:20<00:17, 20.89it/s]
Generating train:  79%|███████▉  | 1429/1800 [01:20<00:19, 19.28it/s]
Generating train:  80%|███████▉  | 1434/1800 [01:20<00:19, 18.55it/s]
Generating train:  80%|███████▉  | 1437/1800 [01:20<00:18, 19.73it/s]
Generating train:  80%|████████  | 1440/1800 [01:20<00:19, 18.14it/s]
Generating train:  80%|████████  | 1444/1800 [01:21<00:16, 21.67it/s]
Generating train:  80%|████████  | 1447/1800 [01:21<00:18, 19.17it/s]
Generating train:  81%|████████  | 1450/1800 [01:21<00:19, 17.57it/s]
Generating train:  81%|████████  | 1452/1800 [01:21<00:24, 14.13it/s]
Generating train:  81%|████████  | 1457/1800 [01:21<00:17, 19.87it/s]
Generating train:  81%|████████  | 1461/1800 [01:22<00:19, 17.45it/s]
Generating train:  81%|████████▏ | 1464/1800 [01:22<00:20, 16.21it/s]
Generating train:  82%|████████▏ | 1469/1800 [01:22<00:16, 19.59it/s]
Generating train:  82%|████████▏ | 1472/1800 [01:22<00:15, 21.08it/s]
Generating train:  82%|████████▏ | 1475/1800 [01:22<00:17, 18.94it/s]
Generating train:  82%|████████▏ | 1478/1800 [01:22<00:16, 19.39it/s]
Generating train:  82%|████████▏ | 1481/1800 [01:23<00:16, 19.36it/s]
Generating train:  82%|████████▎ | 1485/1800 [01:23<00:17, 17.90it/s]
Generating train:  83%|████████▎ | 1488/1800 [01:23<00:19, 15.92it/s]
Generating train:  83%|████████▎ | 1493/1800 [01:23<00:14, 21.08it/s]
Generating train:  83%|████████▎ | 1496/1800 [01:23<00:14, 21.09it/s]
Generating train:  83%|████████▎ | 1500/1800 [01:24<00:18, 16.50it/s]
Generating train:  84%|████████▎ | 1505/1800 [01:24<00:13, 21.78it/s]
Generating train:  84%|████████▍ | 1508/1800 [01:24<00:13, 22.14it/s]
Generating train:  84%|████████▍ | 1511/1800 [01:24<00:12, 23.64it/s]
Generating train:  84%|████████▍ | 1514/1800 [01:24<00:16, 17.69it/s]
Generating train:  84%|████████▍ | 1517/1800 [01:25<00:16, 17.51it/s]
Generating train:  84%|████████▍ | 1520/1800 [01:25<00:19, 14.47it/s]
Generating train:  85%|████████▍ | 1524/1800 [01:25<00:16, 16.46it/s]
Generating train:  85%|████████▍ | 1529/1800 [01:25<00:12, 21.39it/s]
Generating train:  85%|████████▌ | 1532/1800 [01:25<00:16, 16.12it/s]
Generating train:  85%|████████▌ | 1536/1800 [01:26<00:16, 15.72it/s]
Generating train:  86%|████████▌ | 1542/1800 [01:26<00:18, 13.99it/s]
Generating train:  86%|████████▋ | 1553/1800 [01:26<00:10, 24.63it/s]
Generating train:  86%|████████▋ | 1557/1800 [01:27<00:12, 19.74it/s]
Generating train:  87%|████████▋ | 1560/1800 [01:27<00:13, 18.17it/s]
Generating train:  87%|████████▋ | 1566/1800 [01:27<00:13, 17.41it/s]
Generating train:  87%|████████▋ | 1569/1800 [01:27<00:12, 18.58it/s]
Generating train:  87%|████████▋ | 1572/1800 [01:28<00:11, 19.65it/s]
Generating train:  88%|████████▊ | 1578/1800 [01:28<00:13, 15.97it/s]
Generating train:  88%|████████▊ | 1584/1800 [01:28<00:10, 20.93it/s]
Generating train:  88%|████████▊ | 1589/1800 [01:28<00:08, 24.89it/s]
Generating train:  88%|████████▊ | 1593/1800 [01:29<00:11, 17.74it/s]
Generating train:  89%|████████▊ | 1596/1800 [01:29<00:11, 17.99it/s]
Generating train:  89%|████████▉ | 1600/1800 [01:29<00:09, 21.15it/s]
Generating train:  89%|████████▉ | 1603/1800 [01:29<00:12, 16.40it/s]
Generating train:  89%|████████▉ | 1608/1800 [01:29<00:10, 18.98it/s]
Generating train:  90%|████████▉ | 1613/1800 [01:30<00:08, 21.44it/s]
Generating train:  90%|████████▉ | 1616/1800 [01:30<00:10, 17.46it/s]
Generating train:  90%|█████████ | 1620/1800 [01:30<00:12, 14.51it/s]
Generating train:  90%|█████████ | 1626/1800 [01:30<00:09, 18.91it/s]
Generating train:  90%|█████████ | 1629/1800 [01:31<00:10, 16.86it/s]
Generating train:  91%|█████████ | 1632/1800 [01:31<00:09, 17.47it/s]
Generating train:  91%|█████████ | 1638/1800 [01:31<00:08, 19.87it/s]
Generating train:  91%|█████████ | 1641/1800 [01:31<00:09, 17.13it/s]
Generating train:  92%|█████████▏| 1650/1800 [01:32<00:06, 21.73it/s]
Generating train:  92%|█████████▏| 1653/1800 [01:32<00:07, 18.59it/s]
Generating train:  92%|█████████▏| 1656/1800 [01:32<00:10, 13.72it/s]
Generating train:  92%|█████████▏| 1664/1800 [01:32<00:06, 21.45it/s]
Generating train:  93%|█████████▎| 1668/1800 [01:33<00:08, 16.05it/s]
Generating train:  93%|█████████▎| 1677/1800 [01:33<00:05, 22.39it/s]
Generating train:  93%|█████████▎| 1681/1800 [01:34<00:06, 17.49it/s]
Generating train:  94%|█████████▎| 1687/1800 [01:34<00:05, 19.23it/s]
Generating train:  94%|█████████▍| 1691/1800 [01:34<00:05, 18.28it/s]
Generating train:  94%|█████████▍| 1694/1800 [01:34<00:05, 18.68it/s]
Generating train:  94%|█████████▍| 1699/1800 [01:34<00:05, 18.76it/s]
Generating train:  95%|█████████▍| 1703/1800 [01:35<00:05, 18.65it/s]
Generating train:  95%|█████████▍| 1706/1800 [01:35<00:04, 19.58it/s]
Generating train:  95%|█████████▌| 1711/1800 [01:35<00:04, 19.17it/s]
Generating train:  95%|█████████▌| 1715/1800 [01:35<00:04, 19.39it/s]
Generating train:  95%|█████████▌| 1718/1800 [01:35<00:04, 19.78it/s]
Generating train:  96%|█████████▌| 1721/1800 [01:36<00:04, 19.61it/s]
Generating train:  96%|█████████▌| 1727/1800 [01:36<00:04, 16.54it/s]
Generating train:  96%|█████████▌| 1729/1800 [01:36<00:05, 13.42it/s]
Generating train:  97%|█████████▋| 1739/1800 [01:37<00:03, 18.17it/s]
Generating train:  97%|█████████▋| 1741/1800 [01:37<00:03, 16.81it/s]
Generating train:  97%|█████████▋| 1746/1800 [01:37<00:02, 20.80it/s]
Generating train:  97%|█████████▋| 1751/1800 [01:37<00:01, 25.43it/s]
Generating train:  98%|█████████▊| 1755/1800 [01:37<00:02, 18.89it/s]
Generating train:  98%|█████████▊| 1758/1800 [01:38<00:02, 19.40it/s]
Generating train:  98%|█████████▊| 1763/1800 [01:38<00:01, 24.19it/s]
Generating train:  98%|█████████▊| 1767/1800 [01:38<00:02, 15.05it/s]
Generating train:  99%|█████████▊| 1775/1800 [01:38<00:01, 21.43it/s]
Generating train:  99%|█████████▉| 1779/1800 [01:39<00:01, 16.19it/s]
Generating train:  99%|█████████▉| 1787/1800 [01:39<00:00, 22.74it/s]
Generating train: 100%|█████████▉| 1792/1800 [01:39<00:00, 24.32it/s]
Generating train: 100%|█████████▉| 1796/1800 [01:39<00:00, 26.35it/s]
Generating train: 100%|██████████| 1800/1800 [01:40<00:00, 20.87it/s]
Generating train: 100%|██████████| 1800/1800 [01:40<00:00, 17.98it/s]
  Saved 29 shards to /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke...
  Done.
Generating val set...

Generating val:   0%|          | 0/100 [00:00<?, ?it/s]
Generating val:   1%|          | 1/100 [00:02<04:26,  2.69s/it]
Generating val:  13%|█▎        | 13/100 [00:03<00:18,  4.72it/s]
Generating val:  25%|██▌       | 25/100 [00:04<00:08,  8.42it/s]
Generating val:  37%|███▋      | 37/100 [00:04<00:05, 11.11it/s]
Generating val:  42%|████▏     | 42/100 [00:04<00:04, 13.25it/s]
Generating val:  49%|████▉     | 49/100 [00:05<00:03, 13.39it/s]
Generating val:  54%|█████▍    | 54/100 [00:05<00:03, 14.36it/s]
Generating val:  61%|██████    | 61/100 [00:06<00:02, 15.34it/s]
Generating val:  65%|██████▌   | 65/100 [00:06<00:01, 17.56it/s]
Generating val:  68%|██████▊   | 68/100 [00:06<00:02, 14.72it/s]
Generating val:  73%|███████▎  | 73/100 [00:06<00:01, 13.84it/s]
Generating val:  78%|███████▊  | 78/100 [00:07<00:01, 17.03it/s]
Generating val:  85%|████████▌ | 85/100 [00:07<00:00, 20.72it/s]
Generating val:  97%|█████████▋| 97/100 [00:07<00:00, 31.26it/s]
Generating val: 100%|██████████| 100/100 [00:07<00:00, 13.36it/s]
  Saved 2 shards to /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke...
  Done.

==================================================
Running Stage 1: VAE Training
==================================================
Starting VAE training...
Preparing V-only cache for train from shard cache in /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke...

Extracting V-only train:   0%|          | 0/29 [00:00<?, ?it/s]
Extracting V-only train:   3%|▎         | 1/29 [00:00<00:04,  6.68it/s]
Extracting V-only train:   7%|▋         | 2/29 [00:00<00:04,  6.67it/s]
Extracting V-only train:  10%|█         | 3/29 [00:00<00:03,  6.88it/s]
Extracting V-only train:  14%|█▍        | 4/29 [00:00<00:03,  7.09it/s]
Extracting V-only train:  17%|█▋        | 5/29 [00:00<00:03,  6.44it/s]
Extracting V-only train:  21%|██        | 6/29 [00:00<00:03,  6.74it/s]
Extracting V-only train:  24%|██▍       | 7/29 [00:01<00:03,  6.94it/s]
Extracting V-only train:  28%|██▊       | 8/29 [00:01<00:02,  7.10it/s]
Extracting V-only train:  31%|███       | 9/29 [00:01<00:02,  7.22it/s]
Extracting V-only train:  34%|███▍      | 10/29 [00:01<00:02,  7.18it/s]
Extracting V-only train:  38%|███▊      | 11/29 [00:01<00:02,  7.24it/s]
Extracting V-only train:  41%|████▏     | 12/29 [00:01<00:02,  7.30it/s]
Extracting V-only train:  45%|████▍     | 13/29 [00:01<00:02,  7.35it/s]
Extracting V-only train:  48%|████▊     | 14/29 [00:01<00:02,  7.42it/s]
Extracting V-only train:  52%|█████▏    | 15/29 [00:02<00:01,  7.45it/s]
Extracting V-only train:  55%|█████▌    | 16/29 [00:02<00:01,  7.41it/s]
Extracting V-only train:  59%|█████▊    | 17/29 [00:02<00:01,  7.44it/s]
Extracting V-only train:  62%|██████▏   | 18/29 [00:02<00:01,  7.44it/s]
Extracting V-only train:  66%|██████▌   | 19/29 [00:02<00:01,  7.45it/s]
Extracting V-only train:  69%|██████▉   | 20/29 [00:02<00:01,  7.31it/s]
Extracting V-only train:  72%|███████▏  | 21/29 [00:02<00:01,  7.18it/s]
Extracting V-only train:  76%|███████▌  | 22/29 [00:03<00:00,  7.10it/s]
Extracting V-only train:  79%|███████▉  | 23/29 [00:03<00:00,  7.11it/s]
Extracting V-only train:  83%|████████▎ | 24/29 [00:03<00:00,  7.20it/s]
Extracting V-only train:  86%|████████▌ | 25/29 [00:03<00:00,  7.27it/s]
Extracting V-only train:  90%|████████▉ | 26/29 [00:03<00:00,  7.25it/s]
Extracting V-only train:  97%|█████████▋| 28/29 [00:03<00:00,  8.76it/s]
Extracting V-only train: 100%|██████████| 29/29 [00:03<00:00,  7.62it/s]
Using V-only cached shards for train: 29 shards, 1800 samples from /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke
No previous VAE checkpoints found.
Using checkpoint directory: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints
Starting VAE training from scratch...
Using checkpoint directory: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints

Training VAE:   0%|          | 0/500 [00:00<?, ?it/s]
Training VAE:   0%|          | 0/500 [00:00<?, ?it/s, loss=0.237327, recon=0.237327, kl=0.070533]
Training VAE:   0%|          | 1/500 [00:00<06:59,  1.19it/s, loss=0.237327, recon=0.237327, kl=0.070533]
Training VAE:   1%|          | 6/500 [00:00<00:59,  8.27it/s, loss=0.237327, recon=0.237327, kl=0.070533]
Training VAE:   2%|▏         | 12/500 [00:01<00:28, 17.05it/s, loss=0.237327, recon=0.237327, kl=0.070533]
Training VAE:   4%|▎         | 18/500 [00:01<00:18, 25.39it/s, loss=0.237327, recon=0.237327, kl=0.070533]
Training VAE:   5%|▍         | 24/500 [00:01<00:14, 32.81it/s, loss=0.237327, recon=0.237327, kl=0.070533]
Training VAE:   5%|▌         | 25/500 [00:01<00:14, 32.81it/s, loss=0.093568, recon=0.093567, kl=1.094283]
Training VAE:   6%|▌         | 30/500 [00:01<00:12, 38.63it/s, loss=0.093568, recon=0.093567, kl=1.094283]
Training VAE:   7%|▋         | 36/500 [00:01<00:10, 43.07it/s, loss=0.093568, recon=0.093567, kl=1.094283]
Training VAE:   8%|▊         | 42/500 [00:01<00:09, 46.00it/s, loss=0.093568, recon=0.093567, kl=1.094283]
Training VAE:  10%|▉         | 48/500 [00:01<00:09, 47.46it/s, loss=0.093568, recon=0.093567, kl=1.094283]
Training VAE:  10%|█         | 50/500 [00:01<00:09, 47.46it/s, loss=0.018890, recon=0.018888, kl=2.319954]
Training VAE:  11%|█         | 54/500 [00:01<00:09, 49.18it/s, loss=0.018890, recon=0.018888, kl=2.319954]
Training VAE:  12%|█▏        | 60/500 [00:01<00:08, 50.85it/s, loss=0.018890, recon=0.018888, kl=2.319954]
Training VAE:  13%|█▎        | 66/500 [00:02<00:08, 51.96it/s, loss=0.018890, recon=0.018888, kl=2.319954]
Training VAE:  14%|█▍        | 72/500 [00:02<00:08, 52.92it/s, loss=0.018890, recon=0.018888, kl=2.319954]
Training VAE:  15%|█▌        | 75/500 [00:02<00:08, 52.92it/s, loss=0.041347, recon=0.041344, kl=3.036633]
Training VAE:  16%|█▌        | 78/500 [00:02<00:08, 52.58it/s, loss=0.041347, recon=0.041344, kl=3.036633]
Training VAE:  17%|█▋        | 84/500 [00:02<00:07, 53.06it/s, loss=0.041347, recon=0.041344, kl=3.036633]
Training VAE:  18%|█▊        | 90/500 [00:02<00:07, 53.22it/s, loss=0.041347, recon=0.041344, kl=3.036633]
Training VAE:  19%|█▉        | 96/500 [00:02<00:07, 53.38it/s, loss=0.041347, recon=0.041344, kl=3.036633]
Training VAE:  20%|██        | 100/500 [00:02<00:07, 53.38it/s, loss=0.018812, recon=0.018809, kl=3.572672]
Training VAE:  20%|██        | 102/500 [00:02<00:07, 53.37it/s, loss=0.018812, recon=0.018809, kl=3.572672]
Training VAE:  22%|██▏       | 108/500 [00:02<00:07, 52.61it/s, loss=0.018812, recon=0.018809, kl=3.572672]
Training VAE:  23%|██▎       | 114/500 [00:02<00:07, 53.24it/s, loss=0.018812, recon=0.018809, kl=3.572672]
Training VAE:  24%|██▍       | 120/500 [00:03<00:07, 53.86it/s, loss=0.018812, recon=0.018809, kl=3.572672]
Training VAE:  25%|██▌       | 125/500 [00:03<00:06, 53.86it/s, loss=0.024191, recon=0.024187, kl=3.892084]
Training VAE:  25%|██▌       | 126/500 [00:03<00:06, 53.50it/s, loss=0.024191, recon=0.024187, kl=3.892084]
Training VAE:  26%|██▋       | 132/500 [00:03<00:06, 53.42it/s, loss=0.024191, recon=0.024187, kl=3.892084]
Training VAE:  28%|██▊       | 138/500 [00:03<00:06, 53.60it/s, loss=0.024191, recon=0.024187, kl=3.892084]
Training VAE:  29%|██▉       | 144/500 [00:03<00:06, 53.61it/s, loss=0.024191, recon=0.024187, kl=3.892084]
Training VAE:  30%|███       | 150/500 [00:03<00:06, 54.29it/s, loss=0.024191, recon=0.024187, kl=3.892084]
Training VAE:  30%|███       | 150/500 [00:03<00:06, 54.29it/s, loss=0.005301, recon=0.005296, kl=4.642325]
Training VAE:  31%|███       | 156/500 [00:03<00:06, 53.96it/s, loss=0.005301, recon=0.005296, kl=4.642325]
Training VAE:  32%|███▏      | 162/500 [00:03<00:06, 52.21it/s, loss=0.005301, recon=0.005296, kl=4.642325]
Training VAE:  34%|███▎      | 168/500 [00:03<00:06, 52.84it/s, loss=0.005301, recon=0.005296, kl=4.642325]
Training VAE:  35%|███▍      | 174/500 [00:04<00:06, 53.51it/s, loss=0.005301, recon=0.005296, kl=4.642325]
Training VAE:  35%|███▌      | 175/500 [00:04<00:06, 53.51it/s, loss=0.002777, recon=0.002772, kl=4.834289]
Training VAE:  36%|███▌      | 180/500 [00:04<00:05, 53.73it/s, loss=0.002777, recon=0.002772, kl=4.834289]
Training VAE:  37%|███▋      | 186/500 [00:04<00:05, 53.94it/s, loss=0.002777, recon=0.002772, kl=4.834289]
Training VAE:  38%|███▊      | 192/500 [00:04<00:05, 54.17it/s, loss=0.002777, recon=0.002772, kl=4.834289]
Training VAE:  40%|███▉      | 198/500 [00:04<00:05, 54.74it/s, loss=0.002777, recon=0.002772, kl=4.834289]
Training VAE:  40%|████      | 200/500 [00:04<00:05, 54.74it/s, loss=0.007158, recon=0.007153, kl=5.115398]
Training VAE:  41%|████      | 204/500 [00:04<00:05, 51.70it/s, loss=0.007158, recon=0.007153, kl=5.115398]
Training VAE:  42%|████▏     | 210/500 [00:04<00:05, 52.35it/s, loss=0.007158, recon=0.007153, kl=5.115398]
Training VAE:  43%|████▎     | 216/500 [00:04<00:05, 52.87it/s, loss=0.007158, recon=0.007153, kl=5.115398]
Training VAE:  44%|████▍     | 222/500 [00:04<00:05, 52.88it/s, loss=0.007158, recon=0.007153, kl=5.115398]
Training VAE:  45%|████▌     | 225/500 [00:05<00:05, 52.88it/s, loss=0.008933, recon=0.008928, kl=4.915538]
Training VAE:  46%|████▌     | 228/500 [00:05<00:05, 52.36it/s, loss=0.008933, recon=0.008928, kl=4.915538]
Training VAE:  47%|████▋     | 234/500 [00:05<00:04, 53.39it/s, loss=0.008933, recon=0.008928, kl=4.915538]
Training VAE:  48%|████▊     | 240/500 [00:05<00:04, 53.84it/s, loss=0.008933, recon=0.008928, kl=4.915538]
Training VAE:  49%|████▉     | 246/500 [00:05<00:04, 54.52it/s, loss=0.008933, recon=0.008928, kl=4.915538]
Training VAE:  50%|█████     | 250/500 [00:05<00:04, 54.52it/s, loss=0.014201, recon=0.014196, kl=5.166720]
Training VAE:  50%|█████     | 252/500 [00:05<00:04, 52.11it/s, loss=0.014201, recon=0.014196, kl=5.166720]
Training VAE:  52%|█████▏    | 258/500 [00:05<00:04, 52.29it/s, loss=0.014201, recon=0.014196, kl=5.166720]
Training VAE:  53%|█████▎    | 264/500 [00:05<00:04, 53.18it/s, loss=0.014201, recon=0.014196, kl=5.166720]
Training VAE:  54%|█████▍    | 270/500 [00:05<00:04, 52.61it/s, loss=0.014201, recon=0.014196, kl=5.166720]
Training VAE:  55%|█████▌    | 275/500 [00:05<00:04, 52.61it/s, loss=0.006605, recon=0.006599, kl=5.935165]
Training VAE:  55%|█████▌    | 276/500 [00:05<00:04, 53.84it/s, loss=0.006605, recon=0.006599, kl=5.935165]
Training VAE:  57%|█████▋    | 283/500 [00:06<00:03, 57.27it/s, loss=0.006605, recon=0.006599, kl=5.935165]
Training VAE:  58%|█████▊    | 290/500 [00:06<00:03, 59.89it/s, loss=0.006605, recon=0.006599, kl=5.935165]
Training VAE:  59%|█████▉    | 297/500 [00:06<00:03, 61.79it/s, loss=0.006605, recon=0.006599, kl=5.935165]
Training VAE:  60%|██████    | 300/500 [00:06<00:03, 61.79it/s, loss=0.009254, recon=0.009248, kl=5.796703]
Training VAE:  61%|██████    | 304/500 [00:06<00:03, 61.19it/s, loss=0.009254, recon=0.009248, kl=5.796703]
Training VAE:  62%|██████▏   | 311/500 [00:06<00:03, 60.64it/s, loss=0.009254, recon=0.009248, kl=5.796703]
Training VAE:  64%|██████▎   | 318/500 [00:06<00:03, 60.23it/s, loss=0.009254, recon=0.009248, kl=5.796703]
Training VAE:  65%|██████▌   | 325/500 [00:06<00:02, 59.76it/s, loss=0.009254, recon=0.009248, kl=5.796703]
Training VAE:  65%|██████▌   | 325/500 [00:06<00:02, 59.76it/s, loss=0.007945, recon=0.007939, kl=5.851603]
Training VAE:  66%|██████▌   | 331/500 [00:06<00:02, 58.99it/s, loss=0.007945, recon=0.007939, kl=5.851603]
Training VAE:  67%|██████▋   | 337/500 [00:06<00:02, 58.96it/s, loss=0.007945, recon=0.007939, kl=5.851603]
Training VAE:  69%|██████▊   | 343/500 [00:07<00:02, 58.95it/s, loss=0.007945, recon=0.007939, kl=5.851603]
Training VAE:  70%|██████▉   | 349/500 [00:07<00:02, 59.12it/s, loss=0.007945, recon=0.007939, kl=5.851603]
Training VAE:  70%|███████   | 350/500 [00:07<00:02, 59.12it/s, loss=0.002849, recon=0.002843, kl=6.325959]
Training VAE:  71%|███████   | 355/500 [00:07<00:02, 59.07it/s, loss=0.002849, recon=0.002843, kl=6.325959]
Training VAE:  72%|███████▏  | 361/500 [00:07<00:02, 59.19it/s, loss=0.002849, recon=0.002843, kl=6.325959]
Training VAE:  73%|███████▎  | 367/500 [00:07<00:02, 59.36it/s, loss=0.002849, recon=0.002843, kl=6.325959]
Training VAE:  75%|███████▍  | 373/500 [00:07<00:02, 59.15it/s, loss=0.002849, recon=0.002843, kl=6.325959]
Training VAE:  75%|███████▌  | 375/500 [00:07<00:02, 59.15it/s, loss=0.004829, recon=0.004822, kl=6.344438]
Training VAE:  76%|███████▌  | 379/500 [00:07<00:02, 58.68it/s, loss=0.004829, recon=0.004822, kl=6.344438]
Training VAE:  77%|███████▋  | 385/500 [00:07<00:01, 58.72it/s, loss=0.004829, recon=0.004822, kl=6.344438]
Training VAE:  78%|███████▊  | 391/500 [00:07<00:01, 58.59it/s, loss=0.004829, recon=0.004822, kl=6.344438]
Training VAE:  79%|███████▉  | 397/500 [00:07<00:01, 58.55it/s, loss=0.004829, recon=0.004822, kl=6.344438]
Training VAE:  80%|████████  | 400/500 [00:08<00:01, 58.55it/s, loss=0.010235, recon=0.010229, kl=6.289307]
Training VAE:  81%|████████  | 403/500 [00:08<00:01, 58.34it/s, loss=0.010235, recon=0.010229, kl=6.289307]
Training VAE:  82%|████████▏ | 409/500 [00:08<00:01, 58.39it/s, loss=0.010235, recon=0.010229, kl=6.289307]
Training VAE:  83%|████████▎ | 415/500 [00:08<00:01, 58.20it/s, loss=0.010235, recon=0.010229, kl=6.289307]
Training VAE:  84%|████████▍ | 421/500 [00:08<00:01, 58.24it/s, loss=0.010235, recon=0.010229, kl=6.289307]
Training VAE:  85%|████████▌ | 425/500 [00:08<00:01, 58.24it/s, loss=0.005475, recon=0.005469, kl=6.462763]
Training VAE:  85%|████████▌ | 427/500 [00:08<00:01, 52.47it/s, loss=0.005475, recon=0.005469, kl=6.462763]
Training VAE:  87%|████████▋ | 433/500 [00:08<00:01, 48.93it/s, loss=0.005475, recon=0.005469, kl=6.462763]
Training VAE:  88%|████████▊ | 439/500 [00:08<00:01, 50.24it/s, loss=0.005475, recon=0.005469, kl=6.462763]
Training VAE:  89%|████████▉ | 445/500 [00:08<00:01, 51.96it/s, loss=0.005475, recon=0.005469, kl=6.462763]
Training VAE:  90%|█████████ | 450/500 [00:09<00:00, 51.96it/s, loss=0.001271, recon=0.001264, kl=6.739822]
Training VAE:  90%|█████████ | 451/500 [00:09<00:00, 50.49it/s, loss=0.001271, recon=0.001264, kl=6.739822]
Training VAE:  91%|█████████▏| 457/500 [00:09<00:00, 51.95it/s, loss=0.001271, recon=0.001264, kl=6.739822]
Training VAE:  93%|█████████▎| 463/500 [00:09<00:00, 51.53it/s, loss=0.001271, recon=0.001264, kl=6.739822]
Training VAE:  94%|█████████▍| 469/500 [00:09<00:00, 52.48it/s, loss=0.001271, recon=0.001264, kl=6.739822]
Training VAE:  95%|█████████▌| 475/500 [00:09<00:00, 53.31it/s, loss=0.001271, recon=0.001264, kl=6.739822]
Training VAE:  95%|█████████▌| 475/500 [00:09<00:00, 53.31it/s, loss=0.009652, recon=0.009645, kl=6.408314]
Training VAE:  96%|█████████▌| 481/500 [00:09<00:00, 53.92it/s, loss=0.009652, recon=0.009645, kl=6.408314]
Training VAE:  97%|█████████▋| 487/500 [00:09<00:00, 54.09it/s, loss=0.009652, recon=0.009645, kl=6.408314]
Training VAE:  99%|█████████▊| 493/500 [00:09<00:00, 54.70it/s, loss=0.009652, recon=0.009645, kl=6.408314]
Training VAE: 100%|█████████▉| 499/500 [00:09<00:00, 53.63it/s, loss=0.009652, recon=0.009645, kl=6.408314]
Training VAE: 100%|██████████| 500/500 [00:09<00:00, 50.30it/s, loss=0.009652, recon=0.009645, kl=6.408314]

==================================================
Running Stage 2: Latent Green Training
==================================================
Using cached shards for train: 29 shards, 1800 samples from /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke
Searching for checkpoints. Current: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints, Root: /root/data1/GreenDiff/gd/runs
Loading VAE from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/vae_step_500.pt
Starting Latent Green training from scratch...

Training Latent Green:   0%|          | 0/1000 [00:00<?, ?it/s]
                                                               
Step 0: dom line | loss 37.2379 | data 6.9072 | fft 1.5141 | rel 10.2276 | loss_n 0.000284 | data_n 0.000053 | loss_avg 37.2379 | data_avg 6.9072 | rel_avg 10.2276 | lr 1.00e-05 | gn 1.000 | it/s 33.17 | s/s 133 | stats 100.9487 | psd 3.0282 | ms 6.8327 | res 30.2781 | sum 0.5258 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:   0%|          | 0/1000 [00:00<?, ?it/s]
                                                               
Step 0: Pred Obs [0.077, 350402.844] | Obs  Obs [-15337.832, 23324.000]

Training Latent Green:   0%|          | 0/1000 [00:00<?, ?it/s]
                                                               
Step 0: Pred Lin mean/std [0.462, 0.466] | Obs Lin mean/std [0.044, 0.043]

Training Latent Green:   0%|          | 0/1000 [00:00<?, ?it/s]
Training Latent Green:   0%|          | 0/1000 [00:00<?, ?it/s]
Training Latent Green:   0%|          | 1/1000 [00:00<12:58,  1.28it/s]
Training Latent Green:   0%|          | 5/1000 [00:00<02:23,  6.95it/s]
Training Latent Green:   1%|          | 8/1000 [00:01<01:30, 10.95it/s]
Training Latent Green:   1%|          | 12/1000 [00:01<01:03, 15.55it/s]
Training Latent Green:   2%|▏         | 16/1000 [00:01<00:50, 19.38it/s]
Training Latent Green:   2%|▏         | 19/1000 [00:01<00:45, 21.52it/s]
Training Latent Green:   2%|▏         | 23/1000 [00:01<00:40, 23.99it/s]
                                                                        
Step 25: dom line | loss 3.0217 | data 0.6975 | fft 1.5499 | rel 0.9744 | loss_n 0.000023 | data_n 0.000005 | loss_avg 20.1298 | data_avg 3.8024 | rel_avg 5.6010 | lr 5.20e-05 | gn 1.000 | it/s 29.02 | s/s 116 | stats 0.0786 | psd 3.0998 | ms 0.4145 | res 1.9957 | sum 0.9557 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:   2%|▎         | 25/1000 [00:01<00:40, 23.99it/s]
Training Latent Green:   2%|▎         | 25/1000 [00:01<00:40, 23.99it/s]
Training Latent Green:   3%|▎         | 26/1000 [00:01<00:38, 25.34it/s]
Training Latent Green:   3%|▎         | 30/1000 [00:01<00:35, 26.98it/s]
Training Latent Green:   3%|▎         | 33/1000 [00:01<00:35, 27.48it/s]
Training Latent Green:   4%|▎         | 36/1000 [00:01<00:35, 27.31it/s]
Training Latent Green:   4%|▍         | 40/1000 [00:02<00:34, 27.79it/s]
Training Latent Green:   4%|▍         | 43/1000 [00:02<00:34, 27.84it/s]
Training Latent Green:   5%|▍         | 46/1000 [00:02<00:34, 27.98it/s]
Training Latent Green:   5%|▍         | 49/1000 [00:02<00:34, 27.68it/s]
                                                                        
Step 50: dom line | loss 1.8387 | data 0.6961 | fft 2.5374 | rel 0.9210 | loss_n 0.000014 | data_n 0.000005 | loss_avg 14.0328 | data_avg 2.7670 | rel_avg 4.0410 | lr 1.00e-04 | gn 1.000 | it/s 28.46 | s/s 114 | stats 0.6326 | psd 5.0747 | ms 0.5424 | res 0.3018 | sum 0.9903 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:   5%|▌         | 50/1000 [00:02<00:34, 27.68it/s]
Training Latent Green:   5%|▌         | 50/1000 [00:02<00:34, 27.68it/s]
Training Latent Green:   5%|▌         | 52/1000 [00:02<00:33, 28.08it/s]
Training Latent Green:   6%|▌         | 55/1000 [00:02<00:33, 28.16it/s]
Training Latent Green:   6%|▌         | 58/1000 [00:02<00:33, 28.29it/s]
Training Latent Green:   6%|▌         | 61/1000 [00:02<00:33, 27.62it/s]
Training Latent Green:   6%|▋         | 64/1000 [00:02<00:33, 28.05it/s]
Training Latent Green:   7%|▋         | 67/1000 [00:03<00:33, 28.09it/s]
Training Latent Green:   7%|▋         | 70/1000 [00:03<00:33, 27.89it/s]
Training Latent Green:   7%|▋         | 74/1000 [00:03<00:32, 28.66it/s]
                                                                        
Step 75: dom line | loss 1.9172 | data 0.6471 | fft 1.8648 | rel 0.8706 | loss_n 0.000015 | data_n 0.000005 | loss_avg 11.0039 | data_avg 2.2370 | rel_avg 3.2484 | lr 9.98e-05 | gn 1.000 | it/s 27.82 | s/s 111 | stats 0.3790 | psd 3.7296 | ms 0.4289 | res 0.3473 | sum 0.9792 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:   8%|▊         | 75/1000 [00:03<00:32, 28.66it/s]
Training Latent Green:   8%|▊         | 75/1000 [00:03<00:32, 28.66it/s]
Training Latent Green:   8%|▊         | 77/1000 [00:03<00:45, 20.41it/s]
Training Latent Green:   8%|▊         | 80/1000 [00:03<00:42, 21.88it/s]
Training Latent Green:   8%|▊         | 83/1000 [00:03<00:38, 23.69it/s]
Training Latent Green:   9%|▊         | 86/1000 [00:03<00:37, 24.33it/s]
Training Latent Green:   9%|▉         | 90/1000 [00:04<00:33, 27.28it/s]
Training Latent Green:   9%|▉         | 93/1000 [00:04<00:33, 27.36it/s]
Training Latent Green:  10%|▉         | 96/1000 [00:04<00:32, 27.93it/s]
Training Latent Green:  10%|▉         | 99/1000 [00:04<00:31, 28.25it/s]
                                                                        
Step 100: dom line | loss 1.8454 | data 0.6117 | fft 1.3620 | rel 0.8525 | loss_n 0.000014 | data_n 0.000005 | loss_avg 9.1722 | data_avg 1.9119 | rel_avg 2.7692 | lr 9.94e-05 | gn 1.000 | it/s 24.95 | s/s 100 | stats 0.1419 | psd 2.7239 | ms 0.3319 | res 0.3207 | sum 0.9570 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  10%|█         | 100/1000 [00:04<00:31, 28.25it/s]
Training Latent Green:  10%|█         | 100/1000 [00:04<00:31, 28.25it/s]
Training Latent Green:  10%|█         | 102/1000 [00:04<00:32, 27.64it/s]
Training Latent Green:  10%|█         | 105/1000 [00:04<00:32, 27.39it/s]
Training Latent Green:  11%|█         | 108/1000 [00:04<00:32, 27.75it/s]
Training Latent Green:  11%|█         | 112/1000 [00:04<00:30, 28.94it/s]
Training Latent Green:  12%|█▏        | 115/1000 [00:04<00:30, 29.14it/s]
Training Latent Green:  12%|█▏        | 118/1000 [00:04<00:30, 29.13it/s]
Training Latent Green:  12%|█▏        | 121/1000 [00:05<00:30, 28.45it/s]
Training Latent Green:  12%|█▏        | 124/1000 [00:05<00:30, 28.84it/s]
                                                                         
Step 125: dom line | loss 1.6643 | data 0.5920 | fft 1.0573 | rel 0.8379 | loss_n 0.000013 | data_n 0.000005 | loss_avg 7.9209 | data_avg 1.6920 | rel_avg 2.4474 | lr 9.86e-05 | gn 1.000 | it/s 28.63 | s/s 115 | stats 0.1104 | psd 2.1146 | ms 0.2944 | res 0.3037 | sum 0.9563 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  12%|█▎        | 125/1000 [00:05<00:30, 28.84it/s]
                                                                         
Step 125: Pred Obs [0.007, 121913.148] | Obs  Obs [-13674.763, 24910.391]

Training Latent Green:  12%|█▎        | 125/1000 [00:05<00:30, 28.84it/s]
                                                                         
Step 125: Pred Lin mean/std [0.037, 0.029] | Obs Lin mean/std [0.044, 0.043]

Training Latent Green:  12%|█▎        | 125/1000 [00:05<00:30, 28.84it/s]
Training Latent Green:  12%|█▎        | 125/1000 [00:05<00:30, 28.84it/s]
Training Latent Green:  13%|█▎        | 127/1000 [00:05<00:30, 28.82it/s]
Training Latent Green:  13%|█▎        | 130/1000 [00:05<00:30, 28.44it/s]
Training Latent Green:  13%|█▎        | 134/1000 [00:05<00:30, 28.75it/s]
Training Latent Green:  14%|█▎        | 137/1000 [00:05<00:29, 28.87it/s]
Training Latent Green:  14%|█▍        | 140/1000 [00:05<00:29, 28.88it/s]
Training Latent Green:  14%|█▍        | 143/1000 [00:05<00:29, 29.06it/s]
Training Latent Green:  15%|█▍        | 146/1000 [00:05<00:29, 28.78it/s]
Training Latent Green:  15%|█▍        | 149/1000 [00:06<00:29, 28.87it/s]
                                                                         
Step 150: dom line | loss 1.4149 | data 0.5556 | fft 0.9649 | rel 0.8024 | loss_n 0.000011 | data_n 0.000004 | loss_avg 6.9915 | data_avg 1.5296 | rel_avg 2.2124 | lr 9.75e-05 | gn 1.000 | it/s 29.11 | s/s 116 | stats 0.1212 | psd 1.9298 | ms 0.2416 | res 0.1708 | sum 0.9521 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  15%|█▌        | 150/1000 [00:06<00:29, 28.87it/s]
Training Latent Green:  15%|█▌        | 150/1000 [00:06<00:29, 28.87it/s]
Training Latent Green:  15%|█▌        | 153/1000 [00:06<00:28, 29.35it/s]
Training Latent Green:  16%|█▌        | 156/1000 [00:06<00:29, 28.25it/s]
Training Latent Green:  16%|█▌        | 159/1000 [00:06<00:29, 28.48it/s]
Training Latent Green:  16%|█▌        | 162/1000 [00:06<00:29, 28.51it/s]
Training Latent Green:  17%|█▋        | 166/1000 [00:06<00:28, 29.13it/s]
Training Latent Green:  17%|█▋        | 169/1000 [00:06<00:28, 28.90it/s]
Training Latent Green:  17%|█▋        | 172/1000 [00:06<00:28, 28.77it/s]
Training Latent Green:  18%|█▊        | 175/1000 [00:06<00:28, 28.59it/s]
                                                                         
Step 175: dom line | loss 1.3601 | data 0.5436 | fft 0.9476 | rel 0.7886 | loss_n 0.000010 | data_n 0.000004 | loss_avg 6.2875 | data_avg 1.4064 | rel_avg 2.0344 | lr 9.61e-05 | gn 1.000 | it/s 28.57 | s/s 114 | stats 0.1281 | psd 1.8952 | ms 0.2298 | res 0.1358 | sum 0.9501 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  18%|█▊        | 175/1000 [00:07<00:28, 28.59it/s]
Training Latent Green:  18%|█▊        | 175/1000 [00:07<00:28, 28.59it/s]
Training Latent Green:  18%|█▊        | 178/1000 [00:07<00:34, 23.55it/s]
Training Latent Green:  18%|█▊        | 182/1000 [00:07<00:32, 25.14it/s]
Training Latent Green:  18%|█▊        | 185/1000 [00:07<00:31, 26.03it/s]
Training Latent Green:  19%|█▉        | 188/1000 [00:07<00:30, 26.87it/s]
Training Latent Green:  19%|█▉        | 192/1000 [00:07<00:28, 27.95it/s]
Training Latent Green:  20%|█▉        | 196/1000 [00:07<00:27, 28.82it/s]
Training Latent Green:  20%|█▉        | 199/1000 [00:07<00:27, 28.97it/s]
                                                                         
Step 200: dom line | loss 1.3738 | data 0.5495 | fft 0.9551 | rel 0.7911 | loss_n 0.000010 | data_n 0.000004 | loss_avg 5.7416 | data_avg 1.3112 | rel_avg 1.8962 | lr 9.45e-05 | gn 1.000 | it/s 26.75 | s/s 107 | stats 0.1407 | psd 1.9102 | ms 0.2394 | res 0.1420 | sum 0.9488 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  20%|██        | 200/1000 [00:07<00:27, 28.97it/s]
Training Latent Green:  20%|██        | 200/1000 [00:07<00:27, 28.97it/s]
Training Latent Green:  20%|██        | 202/1000 [00:08<00:30, 26.41it/s]
Training Latent Green:  20%|██        | 205/1000 [00:08<00:29, 27.29it/s]
Training Latent Green:  21%|██        | 208/1000 [00:08<00:28, 27.81it/s]
Training Latent Green:  21%|██        | 212/1000 [00:08<00:27, 28.66it/s]
Training Latent Green:  22%|██▏       | 216/1000 [00:08<00:26, 29.14it/s]
Training Latent Green:  22%|██▏       | 219/1000 [00:08<00:27, 28.67it/s]
Training Latent Green:  22%|██▏       | 222/1000 [00:08<00:27, 28.21it/s]
Training Latent Green:  22%|██▎       | 225/1000 [00:08<00:28, 27.67it/s]
                                                                         
Step 225: dom line | loss 1.3822 | data 0.5505 | fft 0.9107 | rel 0.7940 | loss_n 0.000011 | data_n 0.000004 | loss_avg 5.3056 | data_avg 1.2351 | rel_avg 1.7860 | lr 9.26e-05 | gn 1.000 | it/s 27.50 | s/s 110 | stats 0.1299 | psd 1.8214 | ms 0.2456 | res 0.1688 | sum 0.9529 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  22%|██▎       | 225/1000 [00:08<00:28, 27.67it/s]
Training Latent Green:  22%|██▎       | 225/1000 [00:08<00:28, 27.67it/s]
Training Latent Green:  23%|██▎       | 228/1000 [00:08<00:28, 27.07it/s]
Training Latent Green:  23%|██▎       | 231/1000 [00:09<00:27, 27.56it/s]
Training Latent Green:  23%|██▎       | 234/1000 [00:09<00:27, 27.59it/s]
Training Latent Green:  24%|██▎       | 237/1000 [00:09<00:28, 27.23it/s]
Training Latent Green:  24%|██▍       | 240/1000 [00:09<00:27, 27.34it/s]
Training Latent Green:  24%|██▍       | 243/1000 [00:09<00:28, 26.85it/s]
Training Latent Green:  25%|██▍       | 246/1000 [00:09<00:28, 26.67it/s]
Training Latent Green:  25%|██▍       | 249/1000 [00:09<00:27, 27.26it/s]
                                                                         
Step 250: dom line | loss 1.3629 | data 0.5474 | fft 0.8845 | rel 0.7949 | loss_n 0.000010 | data_n 0.000004 | loss_avg 4.9472 | data_avg 1.1726 | rel_avg 1.6959 | lr 9.04e-05 | gn 1.000 | it/s 26.62 | s/s 106 | stats 0.1272 | psd 1.7690 | ms 0.2415 | res 0.1611 | sum 0.9545 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  25%|██▌       | 250/1000 [00:09<00:27, 27.26it/s]
                                                                         
Step 250: Pred Obs [0.006, 120759.586] | Obs  Obs [-15279.302, 28778.230]

Training Latent Green:  25%|██▌       | 250/1000 [00:09<00:27, 27.26it/s]
                                                                         
Step 250: Pred Lin mean/std [0.039, 0.024] | Obs Lin mean/std [0.045, 0.043]

Training Latent Green:  25%|██▌       | 250/1000 [00:09<00:27, 27.26it/s]
Training Latent Green:  25%|██▌       | 250/1000 [00:09<00:27, 27.26it/s]
Training Latent Green:  25%|██▌       | 252/1000 [00:09<00:36, 20.23it/s]
Training Latent Green:  26%|██▌       | 255/1000 [00:10<00:33, 22.27it/s]
Training Latent Green:  26%|██▌       | 258/1000 [00:10<00:31, 23.56it/s]
Training Latent Green:  26%|██▌       | 261/1000 [00:10<00:29, 25.09it/s]
Training Latent Green:  26%|██▋       | 264/1000 [00:10<00:28, 26.15it/s]
Training Latent Green:  27%|██▋       | 267/1000 [00:10<00:27, 26.80it/s]
Training Latent Green:  27%|██▋       | 270/1000 [00:10<00:27, 26.75it/s]
Training Latent Green:  27%|██▋       | 273/1000 [00:10<00:26, 26.96it/s]
                                                                         
Step 275: dom line | loss 1.3046 | data 0.5397 | fft 0.8957 | rel 0.7864 | loss_n 0.000010 | data_n 0.000004 | loss_avg 4.6437 | data_avg 1.1198 | rel_avg 1.6201 | lr 8.80e-05 | gn 1.000 | it/s 25.02 | s/s 100 | stats 0.1313 | psd 1.7914 | ms 0.2321 | res 0.1111 | sum 0.9499 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  28%|██▊       | 275/1000 [00:10<00:26, 26.96it/s]
Training Latent Green:  28%|██▊       | 275/1000 [00:10<00:26, 26.96it/s]
Training Latent Green:  28%|██▊       | 276/1000 [00:10<00:26, 26.94it/s]
Training Latent Green:  28%|██▊       | 280/1000 [00:10<00:25, 28.22it/s]
Training Latent Green:  28%|██▊       | 283/1000 [00:11<00:25, 28.34it/s]
Training Latent Green:  29%|██▊       | 286/1000 [00:11<00:25, 28.07it/s]
Training Latent Green:  29%|██▉       | 289/1000 [00:11<00:25, 28.20it/s]
Training Latent Green:  29%|██▉       | 292/1000 [00:11<00:24, 28.44it/s]
Training Latent Green:  30%|██▉       | 295/1000 [00:11<00:25, 27.90it/s]
Training Latent Green:  30%|██▉       | 299/1000 [00:11<00:24, 29.03it/s]
                                                                         
Step 300: dom line | loss 1.3001 | data 0.5439 | fft 0.8369 | rel 0.8006 | loss_n 0.000010 | data_n 0.000004 | loss_avg 4.3865 | data_avg 1.0755 | rel_avg 1.5571 | lr 8.54e-05 | gn 1.000 | it/s 29.24 | s/s 117 | stats 0.1207 | psd 1.6738 | ms 0.2362 | res 0.1188 | sum 0.9504 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  30%|███       | 300/1000 [00:11<00:24, 29.03it/s]
Training Latent Green:  30%|███       | 300/1000 [00:11<00:24, 29.03it/s]
Training Latent Green:  30%|███       | 303/1000 [00:11<00:22, 30.65it/s]
Training Latent Green:  31%|███       | 307/1000 [00:11<00:23, 28.97it/s]
Training Latent Green:  31%|███       | 310/1000 [00:11<00:23, 28.94it/s]
Training Latent Green:  31%|███▏      | 313/1000 [00:12<00:23, 29.07it/s]
Training Latent Green:  32%|███▏      | 316/1000 [00:12<00:23, 28.55it/s]
Training Latent Green:  32%|███▏      | 319/1000 [00:12<00:25, 27.19it/s]
Training Latent Green:  32%|███▏      | 322/1000 [00:12<00:24, 27.70it/s]
Training Latent Green:  32%|███▎      | 325/1000 [00:12<00:24, 27.68it/s]
                                                                         
Step 325: dom line | loss 1.2834 | data 0.5370 | fft 0.8773 | rel 0.7841 | loss_n 0.000010 | data_n 0.000004 | loss_avg 4.1648 | data_avg 1.0371 | rel_avg 1.5019 | lr 8.25e-05 | gn 1.000 | it/s 27.55 | s/s 110 | stats 0.1271 | psd 1.7546 | ms 0.2276 | res 0.1035 | sum 0.9498 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  32%|███▎      | 325/1000 [00:12<00:24, 27.68it/s]
Training Latent Green:  32%|███▎      | 325/1000 [00:12<00:24, 27.68it/s]
Training Latent Green:  33%|███▎      | 328/1000 [00:12<00:30, 21.80it/s]
Training Latent Green:  33%|███▎      | 331/1000 [00:12<00:28, 23.68it/s]
Training Latent Green:  33%|███▎      | 334/1000 [00:12<00:26, 25.10it/s]
Training Latent Green:  34%|███▍      | 338/1000 [00:13<00:24, 26.90it/s]
Training Latent Green:  34%|███▍      | 341/1000 [00:13<00:23, 27.58it/s]
Training Latent Green:  34%|███▍      | 344/1000 [00:13<00:23, 27.95it/s]
Training Latent Green:  35%|███▍      | 347/1000 [00:13<00:23, 28.20it/s]
Training Latent Green:  35%|███▌      | 350/1000 [00:13<00:23, 27.41it/s]
                                                                         
Step 350: dom line | loss 1.2457 | data 0.5376 | fft 0.8102 | rel 0.7993 | loss_n 0.000010 | data_n 0.000004 | loss_avg 3.9702 | data_avg 1.0038 | rel_avg 1.4550 | lr 7.95e-05 | gn 1.000 | it/s 26.01 | s/s 104 | stats 0.1226 | psd 1.6205 | ms 0.2272 | res 0.0834 | sum 0.9519 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  35%|███▌      | 350/1000 [00:13<00:23, 27.41it/s]
Training Latent Green:  35%|███▌      | 350/1000 [00:13<00:23, 27.41it/s]
Training Latent Green:  35%|███▌      | 353/1000 [00:13<00:26, 24.87it/s]
Training Latent Green:  36%|███▌      | 356/1000 [00:13<00:24, 26.10it/s]
Training Latent Green:  36%|███▌      | 359/1000 [00:13<00:24, 26.03it/s]
Training Latent Green:  36%|███▋      | 363/1000 [00:13<00:22, 28.17it/s]
Training Latent Green:  37%|███▋      | 367/1000 [00:14<00:21, 29.27it/s]
Training Latent Green:  37%|███▋      | 370/1000 [00:14<00:21, 29.30it/s]
Training Latent Green:  37%|███▋      | 373/1000 [00:14<00:22, 28.20it/s]
                                                                         
Step 375: dom line | loss 1.2652 | data 0.5400 | fft 0.8146 | rel 0.7988 | loss_n 0.000010 | data_n 0.000004 | loss_avg 3.8011 | data_avg 0.9748 | rel_avg 1.4140 | lr 7.63e-05 | gn 1.000 | it/s 27.76 | s/s 111 | stats 0.1183 | psd 1.6292 | ms 0.2330 | res 0.0929 | sum 0.9483 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  38%|███▊      | 375/1000 [00:14<00:22, 28.20it/s]
                                                                         
Step 375: Pred Obs [0.122, 113142.492] | Obs  Obs [-14547.531, 23571.320]

Training Latent Green:  38%|███▊      | 375/1000 [00:14<00:22, 28.20it/s]
                                                                         
Step 375: Pred Lin mean/std [0.044, 0.023] | Obs Lin mean/std [0.043, 0.043]

Training Latent Green:  38%|███▊      | 375/1000 [00:14<00:22, 28.20it/s]
Training Latent Green:  38%|███▊      | 375/1000 [00:14<00:22, 28.20it/s]
Training Latent Green:  38%|███▊      | 376/1000 [00:14<00:22, 27.71it/s]
Training Latent Green:  38%|███▊      | 379/1000 [00:14<00:22, 27.84it/s]
Training Latent Green:  38%|███▊      | 382/1000 [00:14<00:22, 27.72it/s]
Training Latent Green:  38%|███▊      | 385/1000 [00:14<00:21, 28.21it/s]
Training Latent Green:  39%|███▉      | 388/1000 [00:14<00:21, 27.87it/s]
Training Latent Green:  39%|███▉      | 392/1000 [00:14<00:20, 29.32it/s]
Training Latent Green:  40%|███▉      | 396/1000 [00:15<00:20, 28.99it/s]
Training Latent Green:  40%|███▉      | 399/1000 [00:15<00:21, 27.39it/s]
                                                                         
Step 400: dom line | loss 1.2562 | data 0.5427 | fft 0.8037 | rel 0.8012 | loss_n 0.000010 | data_n 0.000004 | loss_avg 3.6514 | data_avg 0.9494 | rel_avg 1.3780 | lr 7.29e-05 | gn 1.000 | it/s 28.01 | s/s 112 | stats 0.1088 | psd 1.6074 | ms 0.2309 | res 0.1058 | sum 0.9502 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  40%|████      | 400/1000 [00:15<00:21, 27.39it/s]
Training Latent Green:  40%|████      | 400/1000 [00:15<00:21, 27.39it/s]
Training Latent Green:  40%|████      | 403/1000 [00:15<00:21, 27.62it/s]
Training Latent Green:  41%|████      | 407/1000 [00:15<00:20, 28.52it/s]
Training Latent Green:  41%|████      | 410/1000 [00:15<00:20, 28.25it/s]
Training Latent Green:  41%|████▏     | 413/1000 [00:15<00:20, 28.49it/s]
Training Latent Green:  42%|████▏     | 417/1000 [00:15<00:20, 28.95it/s]
Training Latent Green:  42%|████▏     | 420/1000 [00:15<00:21, 26.91it/s]
Training Latent Green:  42%|████▏     | 424/1000 [00:16<00:20, 28.15it/s]
                                                                         
Step 425: dom line | loss 1.2282 | data 0.5382 | fft 0.7719 | rel 0.8063 | loss_n 0.000009 | data_n 0.000004 | loss_avg 3.5168 | data_avg 0.9265 | rel_avg 1.3462 | lr 6.95e-05 | gn 1.000 | it/s 28.34 | s/s 113 | stats 0.1070 | psd 1.5439 | ms 0.2272 | res 0.0898 | sum 0.9510 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  42%|████▎     | 425/1000 [00:16<00:20, 28.15it/s]
Training Latent Green:  42%|████▎     | 425/1000 [00:16<00:20, 28.15it/s]
Training Latent Green:  43%|████▎     | 427/1000 [00:16<00:25, 22.90it/s]
Training Latent Green:  43%|████▎     | 430/1000 [00:16<00:23, 24.26it/s]
Training Latent Green:  43%|████▎     | 434/1000 [00:16<00:21, 25.91it/s]
Training Latent Green:  44%|████▎     | 437/1000 [00:16<00:21, 26.02it/s]
Training Latent Green:  44%|████▍     | 440/1000 [00:16<00:20, 26.84it/s]
Training Latent Green:  44%|████▍     | 444/1000 [00:16<00:19, 27.95it/s]
Training Latent Green:  45%|████▍     | 447/1000 [00:17<00:19, 28.34it/s]
                                                                         
Step 450: dom line | loss 1.2088 | data 0.5333 | fft 0.7747 | rel 0.8011 | loss_n 0.000009 | data_n 0.000004 | loss_avg 3.3953 | data_avg 0.9058 | rel_avg 1.3175 | lr 6.59e-05 | gn 1.000 | it/s 23.59 | s/s 94 | stats 0.1131 | psd 1.5493 | ms 0.2251 | res 0.0688 | sum 0.9501 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  45%|████▌     | 450/1000 [00:17<00:19, 28.34it/s]
Training Latent Green:  45%|████▌     | 450/1000 [00:17<00:19, 28.34it/s]
Training Latent Green:  45%|████▌     | 451/1000 [00:17<00:24, 22.75it/s]
Training Latent Green:  45%|████▌     | 454/1000 [00:17<00:22, 23.88it/s]
Training Latent Green:  46%|████▌     | 457/1000 [00:17<00:22, 24.56it/s]
Training Latent Green:  46%|████▌     | 461/1000 [00:17<00:20, 26.90it/s]
Training Latent Green:  46%|████▋     | 464/1000 [00:17<00:20, 26.72it/s]
Training Latent Green:  47%|████▋     | 467/1000 [00:17<00:19, 27.14it/s]
Training Latent Green:  47%|████▋     | 470/1000 [00:17<00:19, 27.72it/s]
Training Latent Green:  47%|████▋     | 473/1000 [00:18<00:18, 27.84it/s]
                                                                         
Step 475: dom line | loss 1.2431 | data 0.5423 | fft 0.7785 | rel 0.8065 | loss_n 0.000009 | data_n 0.000004 | loss_avg 3.2877 | data_avg 0.8877 | rel_avg 1.2920 | lr 6.23e-05 | gn 1.000 | it/s 28.38 | s/s 114 | stats 0.1038 | psd 1.5569 | ms 0.2304 | res 0.1014 | sum 0.9514 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  48%|████▊     | 475/1000 [00:18<00:18, 27.84it/s]
Training Latent Green:  48%|████▊     | 475/1000 [00:18<00:18, 27.84it/s]
Training Latent Green:  48%|████▊     | 476/1000 [00:18<00:18, 27.72it/s]
Training Latent Green:  48%|████▊     | 479/1000 [00:18<00:18, 27.45it/s]
Training Latent Green:  48%|████▊     | 482/1000 [00:18<00:19, 26.71it/s]
Training Latent Green:  48%|████▊     | 485/1000 [00:18<00:18, 27.44it/s]
Training Latent Green:  49%|████▉     | 488/1000 [00:18<00:18, 27.34it/s]
Training Latent Green:  49%|████▉     | 491/1000 [00:18<00:18, 27.96it/s]
Training Latent Green:  50%|████▉     | 495/1000 [00:18<00:17, 29.44it/s]
Training Latent Green:  50%|████▉     | 499/1000 [00:18<00:16, 30.03it/s]
                                                                         
Step 500: dom line | loss 1.1919 | data 0.5311 | fft 0.7725 | rel 0.7946 | loss_n 0.000009 | data_n 0.000004 | loss_avg 3.1879 | data_avg 0.8707 | rel_avg 1.2683 | lr 5.86e-05 | gn 1.000 | it/s 28.45 | s/s 114 | stats 0.1132 | psd 1.5450 | ms 0.2230 | res 0.0665 | sum 0.9494 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  50%|█████     | 500/1000 [00:19<00:16, 30.03it/s]
                                                                         
Step 500: Pred Obs [0.079, 107330.320] | Obs  Obs [-16623.391, 23765.346]

Training Latent Green:  50%|█████     | 500/1000 [00:19<00:16, 30.03it/s]
                                                                         
Step 500: Pred Lin mean/std [0.043, 0.024] | Obs Lin mean/std [0.044, 0.043]

Training Latent Green:  50%|█████     | 500/1000 [00:19<00:16, 30.03it/s]
Training Latent Green:  50%|█████     | 500/1000 [00:19<00:16, 30.03it/s]
Training Latent Green:  50%|█████     | 502/1000 [00:19<00:22, 22.32it/s]
Training Latent Green:  51%|█████     | 506/1000 [00:19<00:19, 25.17it/s]
Training Latent Green:  51%|█████     | 510/1000 [00:19<00:17, 27.80it/s]
Training Latent Green:  51%|█████▏    | 514/1000 [00:19<00:16, 29.18it/s]
Training Latent Green:  52%|█████▏    | 518/1000 [00:19<00:16, 28.55it/s]
Training Latent Green:  52%|█████▏    | 521/1000 [00:19<00:16, 28.79it/s]
Training Latent Green:  52%|█████▏    | 524/1000 [00:19<00:16, 28.63it/s]
                                                                         
Step 525: dom line | loss 1.2335 | data 0.5391 | fft 0.7967 | rel 0.7981 | loss_n 0.000009 | data_n 0.000004 | loss_avg 3.0991 | data_avg 0.8556 | rel_avg 1.2469 | lr 5.49e-05 | gn 1.000 | it/s 26.92 | s/s 108 | stats 0.1094 | psd 1.5935 | ms 0.2252 | res 0.0922 | sum 0.9493 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  52%|█████▎    | 525/1000 [00:19<00:16, 28.63it/s]
Training Latent Green:  52%|█████▎    | 525/1000 [00:19<00:16, 28.63it/s]
Training Latent Green:  53%|█████▎    | 527/1000 [00:19<00:17, 26.79it/s]
Training Latent Green:  53%|█████▎    | 530/1000 [00:20<00:17, 26.98it/s]
Training Latent Green:  53%|█████▎    | 533/1000 [00:20<00:16, 27.70it/s]
Training Latent Green:  54%|█████▎    | 536/1000 [00:20<00:16, 27.95it/s]
Training Latent Green:  54%|█████▍    | 539/1000 [00:20<00:16, 28.35it/s]
Training Latent Green:  54%|█████▍    | 542/1000 [00:20<00:15, 28.74it/s]
Training Latent Green:  55%|█████▍    | 546/1000 [00:20<00:15, 29.92it/s]
Training Latent Green:  55%|█████▌    | 550/1000 [00:20<00:14, 31.76it/s]
                                                                         
Step 550: dom line | loss 1.2031 | data 0.5351 | fft 0.7773 | rel 0.7980 | loss_n 0.000009 | data_n 0.000004 | loss_avg 3.0167 | data_avg 0.8417 | rel_avg 1.2274 | lr 5.11e-05 | gn 1.000 | it/s 29.60 | s/s 118 | stats 0.1126 | psd 1.5546 | ms 0.2269 | res 0.0737 | sum 0.9496 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  55%|█████▌    | 550/1000 [00:20<00:14, 31.76it/s]
Training Latent Green:  55%|█████▌    | 550/1000 [00:20<00:14, 31.76it/s]
Training Latent Green:  55%|█████▌    | 554/1000 [00:20<00:13, 32.64it/s]
Training Latent Green:  56%|█████▌    | 558/1000 [00:20<00:13, 33.19it/s]
Training Latent Green:  56%|█████▌    | 562/1000 [00:21<00:13, 32.45it/s]
Training Latent Green:  57%|█████▋    | 566/1000 [00:21<00:13, 31.71it/s]
Training Latent Green:  57%|█████▋    | 570/1000 [00:21<00:14, 30.27it/s]
Training Latent Green:  57%|█████▋    | 574/1000 [00:21<00:14, 28.93it/s]
                                                                         
Step 575: dom line | loss 1.2016 | data 0.5356 | fft 0.7631 | rel 0.8031 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.9410 | data_avg 0.8289 | rel_avg 1.2097 | lr 4.74e-05 | gn 1.000 | it/s 30.08 | s/s 120 | stats 0.1008 | psd 1.5261 | ms 0.2247 | res 0.0821 | sum 0.9510 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  57%|█████▊    | 575/1000 [00:21<00:14, 28.93it/s]
Training Latent Green:  57%|█████▊    | 575/1000 [00:21<00:14, 28.93it/s]
Training Latent Green:  58%|█████▊    | 577/1000 [00:21<00:14, 28.42it/s]
Training Latent Green:  58%|█████▊    | 581/1000 [00:21<00:14, 28.20it/s]
Training Latent Green:  58%|█████▊    | 585/1000 [00:21<00:14, 28.52it/s]
Training Latent Green:  59%|█████▉    | 588/1000 [00:22<00:14, 27.80it/s]
Training Latent Green:  59%|█████▉    | 592/1000 [00:22<00:14, 28.91it/s]
Training Latent Green:  60%|█████▉    | 595/1000 [00:22<00:14, 28.34it/s]
Training Latent Green:  60%|█████▉    | 598/1000 [00:22<00:14, 28.39it/s]
                                                                         
Step 600: dom line | loss 1.1638 | data 0.5323 | fft 0.7479 | rel 0.8040 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.8699 | data_avg 0.8171 | rel_avg 1.1935 | lr 4.38e-05 | gn 1.000 | it/s 28.03 | s/s 112 | stats 0.1087 | psd 1.4958 | ms 0.2173 | res 0.0555 | sum 0.9498 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  60%|██████    | 600/1000 [00:22<00:14, 28.39it/s]
Training Latent Green:  60%|██████    | 600/1000 [00:22<00:14, 28.39it/s]
Training Latent Green:  60%|██████    | 601/1000 [00:22<00:14, 27.99it/s]
Training Latent Green:  60%|██████    | 604/1000 [00:22<00:14, 28.26it/s]
Training Latent Green:  61%|██████    | 607/1000 [00:22<00:14, 27.74it/s]
Training Latent Green:  61%|██████    | 610/1000 [00:22<00:13, 28.20it/s]
Training Latent Green:  61%|██████▏   | 613/1000 [00:22<00:13, 28.17it/s]
Training Latent Green:  62%|██████▏   | 616/1000 [00:23<00:13, 27.78it/s]
Training Latent Green:  62%|██████▏   | 619/1000 [00:23<00:13, 27.85it/s]
Training Latent Green:  62%|██████▏   | 622/1000 [00:23<00:13, 28.10it/s]
Training Latent Green:  62%|██████▎   | 625/1000 [00:23<00:13, 27.33it/s]
                                                                         
Step 625: dom line | loss 1.1578 | data 0.5316 | fft 0.7341 | rel 0.8070 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.8041 | data_avg 0.8061 | rel_avg 1.1786 | lr 4.02e-05 | gn 1.000 | it/s 27.74 | s/s 111 | stats 0.1039 | psd 1.4682 | ms 0.2178 | res 0.0534 | sum 0.9499 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  62%|██████▎   | 625/1000 [00:23<00:13, 27.33it/s]
                                                                         
Step 625: Pred Obs [0.020, 110382.078] | Obs  Obs [-13670.952, 27275.207]

Training Latent Green:  62%|██████▎   | 625/1000 [00:23<00:13, 27.33it/s]
                                                                         
Step 625: Pred Lin mean/std [0.042, 0.025] | Obs Lin mean/std [0.043, 0.043]

Training Latent Green:  62%|██████▎   | 625/1000 [00:23<00:13, 27.33it/s]
Training Latent Green:  62%|██████▎   | 625/1000 [00:23<00:13, 27.33it/s]
Training Latent Green:  63%|██████▎   | 628/1000 [00:23<00:17, 21.18it/s]
Training Latent Green:  63%|██████▎   | 631/1000 [00:23<00:15, 23.13it/s]
Training Latent Green:  63%|██████▎   | 634/1000 [00:23<00:15, 24.37it/s]
Training Latent Green:  64%|██████▎   | 637/1000 [00:23<00:14, 25.13it/s]
Training Latent Green:  64%|██████▍   | 640/1000 [00:24<00:13, 25.79it/s]
Training Latent Green:  64%|██████▍   | 643/1000 [00:24<00:13, 26.42it/s]
Training Latent Green:  65%|██████▍   | 646/1000 [00:24<00:13, 26.36it/s]
Training Latent Green:  65%|██████▌   | 650/1000 [00:24<00:12, 28.07it/s]
                                                                         
Step 650: dom line | loss 1.1665 | data 0.5361 | fft 0.7476 | rel 0.8073 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.7434 | data_avg 0.7961 | rel_avg 1.1649 | lr 3.68e-05 | gn 1.000 | it/s 25.20 | s/s 101 | stats 0.1100 | psd 1.4952 | ms 0.2242 | res 0.0589 | sum 0.9481 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  65%|██████▌   | 650/1000 [00:24<00:12, 28.07it/s]
Training Latent Green:  65%|██████▌   | 650/1000 [00:24<00:12, 28.07it/s]
Training Latent Green:  65%|██████▌   | 654/1000 [00:24<00:12, 28.43it/s]
Training Latent Green:  66%|██████▌   | 657/1000 [00:24<00:12, 27.98it/s]
Training Latent Green:  66%|██████▌   | 660/1000 [00:24<00:12, 27.85it/s]
Training Latent Green:  66%|██████▋   | 663/1000 [00:24<00:11, 28.30it/s]
Training Latent Green:  67%|██████▋   | 666/1000 [00:24<00:11, 28.17it/s]
Training Latent Green:  67%|██████▋   | 670/1000 [00:25<00:10, 30.23it/s]
Training Latent Green:  67%|██████▋   | 674/1000 [00:25<00:11, 29.10it/s]
                                                                         
Step 675: dom line | loss 1.1944 | data 0.5331 | fft 0.7660 | rel 0.7982 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.6881 | data_avg 0.7867 | rel_avg 1.1518 | lr 3.35e-05 | gn 1.000 | it/s 28.79 | s/s 115 | stats 0.1090 | psd 1.5320 | ms 0.2220 | res 0.0719 | sum 0.9510 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  68%|██████▊   | 675/1000 [00:25<00:11, 29.10it/s]
Training Latent Green:  68%|██████▊   | 675/1000 [00:25<00:11, 29.10it/s]
Training Latent Green:  68%|██████▊   | 677/1000 [00:25<00:11, 28.88it/s]
Training Latent Green:  68%|██████▊   | 681/1000 [00:25<00:11, 28.94it/s]
Training Latent Green:  68%|██████▊   | 684/1000 [00:25<00:11, 28.48it/s]
Training Latent Green:  69%|██████▉   | 688/1000 [00:25<00:10, 30.19it/s]
Training Latent Green:  69%|██████▉   | 692/1000 [00:25<00:10, 29.12it/s]
Training Latent Green:  70%|██████▉   | 695/1000 [00:25<00:10, 27.97it/s]
Training Latent Green:  70%|██████▉   | 699/1000 [00:26<00:10, 28.90it/s]
                                                                         
Step 700: dom line | loss 1.1899 | data 0.5324 | fft 0.7586 | rel 0.8002 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.6365 | data_avg 0.7779 | rel_avg 1.1396 | lr 3.03e-05 | gn 1.000 | it/s 28.55 | s/s 114 | stats 0.1019 | psd 1.5172 | ms 0.2212 | res 0.0761 | sum 0.9504 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  70%|███████   | 700/1000 [00:26<00:10, 28.90it/s]
Training Latent Green:  70%|███████   | 700/1000 [00:26<00:10, 28.90it/s]
Training Latent Green:  70%|███████   | 702/1000 [00:26<00:13, 22.76it/s]
Training Latent Green:  70%|███████   | 705/1000 [00:26<00:12, 23.66it/s]
Training Latent Green:  71%|███████   | 708/1000 [00:26<00:11, 24.64it/s]
Training Latent Green:  71%|███████   | 712/1000 [00:26<00:10, 26.39it/s]
Training Latent Green:  72%|███████▏  | 715/1000 [00:26<00:10, 26.99it/s]
Training Latent Green:  72%|███████▏  | 718/1000 [00:26<00:10, 27.22it/s]
Training Latent Green:  72%|███████▏  | 721/1000 [00:26<00:10, 26.91it/s]
Training Latent Green:  72%|███████▏  | 724/1000 [00:27<00:09, 27.70it/s]
                                                                         
Step 725: dom line | loss 1.1680 | data 0.5309 | fft 0.7378 | rel 0.8058 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.5875 | data_avg 0.7697 | rel_avg 1.1285 | lr 2.72e-05 | gn 1.000 | it/s 25.52 | s/s 102 | stats 0.0993 | psd 1.4755 | ms 0.2189 | res 0.0581 | sum 0.9492 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  72%|███████▎  | 725/1000 [00:27<00:09, 27.70it/s]
Training Latent Green:  72%|███████▎  | 725/1000 [00:27<00:09, 27.70it/s]
Training Latent Green:  73%|███████▎  | 727/1000 [00:27<00:10, 25.74it/s]
Training Latent Green:  73%|███████▎  | 730/1000 [00:27<00:10, 26.12it/s]
Training Latent Green:  73%|███████▎  | 734/1000 [00:27<00:09, 27.37it/s]
Training Latent Green:  74%|███████▎  | 737/1000 [00:27<00:09, 27.56it/s]
Training Latent Green:  74%|███████▍  | 741/1000 [00:27<00:09, 28.55it/s]
Training Latent Green:  74%|███████▍  | 744/1000 [00:27<00:09, 28.29it/s]
Training Latent Green:  75%|███████▍  | 748/1000 [00:27<00:08, 28.78it/s]
                                                                         
Step 750: dom line | loss 1.1660 | data 0.5338 | fft 0.7377 | rel 0.8076 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.5416 | data_avg 0.7621 | rel_avg 1.1182 | lr 2.44e-05 | gn 1.000 | it/s 27.20 | s/s 109 | stats 0.1016 | psd 1.4753 | ms 0.2202 | res 0.0628 | sum 0.9498 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  75%|███████▌  | 750/1000 [00:28<00:08, 28.78it/s]
                                                                         
Step 750: Pred Obs [0.096, 106880.188] | Obs  Obs [-16281.938, 25600.576]

Training Latent Green:  75%|███████▌  | 750/1000 [00:28<00:08, 28.78it/s]
                                                                         
Step 750: Pred Lin mean/std [0.042, 0.025] | Obs Lin mean/std [0.044, 0.043]

Training Latent Green:  75%|███████▌  | 750/1000 [00:28<00:08, 28.78it/s]
Training Latent Green:  75%|███████▌  | 750/1000 [00:28<00:08, 28.78it/s]
Training Latent Green:  75%|███████▌  | 751/1000 [00:28<00:09, 27.09it/s]
Training Latent Green:  75%|███████▌  | 754/1000 [00:28<00:08, 27.83it/s]
Training Latent Green:  76%|███████▌  | 757/1000 [00:28<00:08, 27.01it/s]
Training Latent Green:  76%|███████▌  | 760/1000 [00:28<00:08, 27.23it/s]
Training Latent Green:  76%|███████▋  | 764/1000 [00:28<00:08, 28.04it/s]
Training Latent Green:  77%|███████▋  | 767/1000 [00:28<00:08, 28.15it/s]
Training Latent Green:  77%|███████▋  | 770/1000 [00:28<00:08, 28.46it/s]
Training Latent Green:  77%|███████▋  | 773/1000 [00:28<00:07, 28.54it/s]
                                                                         
Step 775: dom line | loss 1.1629 | data 0.5300 | fft 0.7408 | rel 0.8017 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.4986 | data_avg 0.7548 | rel_avg 1.1083 | lr 2.18e-05 | gn 1.000 | it/s 28.50 | s/s 114 | stats 0.1006 | psd 1.4817 | ms 0.2183 | res 0.0614 | sum 0.9497 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  78%|███████▊  | 775/1000 [00:28<00:07, 28.54it/s]
Training Latent Green:  78%|███████▊  | 775/1000 [00:28<00:07, 28.54it/s]
Training Latent Green:  78%|███████▊  | 776/1000 [00:28<00:07, 28.82it/s]
Training Latent Green:  78%|███████▊  | 779/1000 [00:29<00:07, 28.97it/s]
Training Latent Green:  78%|███████▊  | 782/1000 [00:29<00:07, 28.88it/s]
Training Latent Green:  78%|███████▊  | 785/1000 [00:29<00:07, 28.97it/s]
Training Latent Green:  79%|███████▉  | 788/1000 [00:29<00:07, 27.20it/s]
Training Latent Green:  79%|███████▉  | 792/1000 [00:29<00:07, 28.64it/s]
Training Latent Green:  80%|███████▉  | 795/1000 [00:29<00:07, 28.26it/s]
Training Latent Green:  80%|███████▉  | 798/1000 [00:29<00:07, 28.24it/s]
                                                                         
Step 800: dom line | loss 1.1436 | data 0.5319 | fft 0.7231 | rel 0.8102 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.4575 | data_avg 0.7481 | rel_avg 1.0992 | lr 1.94e-05 | gn 1.000 | it/s 27.80 | s/s 111 | stats 0.1012 | psd 1.4463 | ms 0.2176 | res 0.0501 | sum 0.9504 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  80%|████████  | 800/1000 [00:29<00:07, 28.24it/s]
Training Latent Green:  80%|████████  | 800/1000 [00:29<00:07, 28.24it/s]
Training Latent Green:  80%|████████  | 801/1000 [00:29<00:09, 21.91it/s]
Training Latent Green:  80%|████████  | 804/1000 [00:30<00:08, 22.54it/s]
Training Latent Green:  81%|████████  | 807/1000 [00:30<00:08, 23.18it/s]
Training Latent Green:  81%|████████  | 810/1000 [00:30<00:08, 21.68it/s]
Training Latent Green:  81%|████████▏ | 813/1000 [00:30<00:08, 22.50it/s]
Training Latent Green:  82%|████████▏ | 816/1000 [00:30<00:08, 22.02it/s]
Training Latent Green:  82%|████████▏ | 819/1000 [00:30<00:08, 22.28it/s]
Training Latent Green:  82%|████████▏ | 822/1000 [00:30<00:07, 22.34it/s]
Training Latent Green:  82%|████████▎ | 825/1000 [00:30<00:08, 21.48it/s]
                                                                         
Step 825: dom line | loss 1.1531 | data 0.5330 | fft 0.7164 | rel 0.8135 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.4191 | data_avg 0.7417 | rel_avg 1.0908 | lr 1.72e-05 | gn 1.000 | it/s 20.29 | s/s 81 | stats 0.0935 | psd 1.4328 | ms 0.2201 | res 0.0567 | sum 0.9486 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  82%|████████▎ | 825/1000 [00:31<00:08, 21.48it/s]
Training Latent Green:  82%|████████▎ | 825/1000 [00:31<00:08, 21.48it/s]
Training Latent Green:  83%|████████▎ | 828/1000 [00:31<00:09, 18.57it/s]
Training Latent Green:  83%|████████▎ | 831/1000 [00:31<00:08, 19.27it/s]
Training Latent Green:  83%|████████▎ | 834/1000 [00:31<00:08, 20.21it/s]
Training Latent Green:  84%|████████▎ | 837/1000 [00:31<00:07, 21.12it/s]
Training Latent Green:  84%|████████▍ | 840/1000 [00:31<00:07, 22.27it/s]
Training Latent Green:  84%|████████▍ | 843/1000 [00:31<00:06, 23.30it/s]
Training Latent Green:  85%|████████▍ | 846/1000 [00:31<00:06, 24.38it/s]
Training Latent Green:  85%|████████▍ | 849/1000 [00:32<00:06, 25.00it/s]
                                                                         
Step 850: dom line | loss 1.1682 | data 0.5343 | fft 0.7289 | rel 0.8104 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.3834 | data_avg 0.7358 | rel_avg 1.0828 | lr 1.54e-05 | gn 1.000 | it/s 22.73 | s/s 91 | stats 0.0922 | psd 1.4577 | ms 0.2194 | res 0.0689 | sum 0.9502 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  85%|████████▌ | 850/1000 [00:32<00:05, 25.00it/s]
Training Latent Green:  85%|████████▌ | 850/1000 [00:32<00:05, 25.00it/s]
Training Latent Green:  85%|████████▌ | 852/1000 [00:32<00:07, 20.46it/s]
Training Latent Green:  86%|████████▌ | 855/1000 [00:32<00:06, 21.57it/s]
Training Latent Green:  86%|████████▌ | 858/1000 [00:32<00:06, 23.20it/s]
Training Latent Green:  86%|████████▌ | 861/1000 [00:32<00:05, 24.57it/s]
Training Latent Green:  86%|████████▋ | 864/1000 [00:32<00:05, 25.84it/s]
Training Latent Green:  87%|████████▋ | 867/1000 [00:32<00:05, 26.52it/s]
Training Latent Green:  87%|████████▋ | 870/1000 [00:32<00:04, 26.95it/s]
Training Latent Green:  87%|████████▋ | 873/1000 [00:33<00:04, 27.29it/s]
                                                                         
Step 875: dom line | loss 1.1582 | data 0.5319 | fft 0.7135 | rel 0.8125 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.3494 | data_avg 0.7302 | rel_avg 1.0753 | lr 1.37e-05 | gn 1.000 | it/s 25.27 | s/s 101 | stats 0.0908 | psd 1.4271 | ms 0.2177 | res 0.0601 | sum 0.9496 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  88%|████████▊ | 875/1000 [00:33<00:04, 27.29it/s]
                                                                         
Step 875: Pred Obs [0.169, 112622.930] | Obs  Obs [-14416.854, 23734.121]

Training Latent Green:  88%|████████▊ | 875/1000 [00:33<00:04, 27.29it/s]
                                                                         
Step 875: Pred Lin mean/std [0.043, 0.026] | Obs Lin mean/std [0.044, 0.043]

Training Latent Green:  88%|████████▊ | 875/1000 [00:33<00:04, 27.29it/s]
Training Latent Green:  88%|████████▊ | 875/1000 [00:33<00:04, 27.29it/s]
Training Latent Green:  88%|████████▊ | 876/1000 [00:33<00:04, 25.68it/s]
Training Latent Green:  88%|████████▊ | 879/1000 [00:33<00:04, 26.78it/s]
Training Latent Green:  88%|████████▊ | 882/1000 [00:33<00:04, 25.97it/s]
Training Latent Green:  88%|████████▊ | 885/1000 [00:33<00:04, 26.60it/s]
Training Latent Green:  89%|████████▉ | 888/1000 [00:33<00:04, 27.11it/s]
Training Latent Green:  89%|████████▉ | 891/1000 [00:33<00:04, 27.13it/s]
Training Latent Green:  89%|████████▉ | 894/1000 [00:33<00:03, 27.59it/s]
Training Latent Green:  90%|████████▉ | 897/1000 [00:33<00:03, 27.85it/s]
Training Latent Green:  90%|█████████ | 900/1000 [00:34<00:03, 28.42it/s]
                                                                         
Step 900: dom line | loss 1.1395 | data 0.5288 | fft 0.7239 | rel 0.8062 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.3167 | data_avg 0.7247 | rel_avg 1.0680 | lr 1.24e-05 | gn 1.000 | it/s 24.36 | s/s 97 | stats 0.0994 | psd 1.4477 | ms 0.2168 | res 0.0474 | sum 0.9489 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  90%|█████████ | 900/1000 [00:34<00:03, 28.42it/s]
Training Latent Green:  90%|█████████ | 900/1000 [00:34<00:03, 28.42it/s]
Training Latent Green:  90%|█████████ | 903/1000 [00:34<00:05, 18.44it/s]
Training Latent Green:  91%|█████████ | 906/1000 [00:34<00:04, 20.56it/s]
Training Latent Green:  91%|█████████ | 910/1000 [00:34<00:03, 23.41it/s]
Training Latent Green:  91%|█████████▏| 913/1000 [00:34<00:03, 24.10it/s]
Training Latent Green:  92%|█████████▏| 916/1000 [00:34<00:03, 25.19it/s]
Training Latent Green:  92%|█████████▏| 919/1000 [00:34<00:03, 26.15it/s]
Training Latent Green:  92%|█████████▏| 923/1000 [00:35<00:02, 27.43it/s]
                                                                         
Step 925: dom line | loss 1.1807 | data 0.5357 | fft 0.7322 | rel 0.8110 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.2868 | data_avg 0.7197 | rel_avg 1.0613 | lr 1.13e-05 | gn 1.000 | it/s 26.26 | s/s 105 | stats 0.0911 | psd 1.4645 | ms 0.2211 | res 0.0728 | sum 0.9495 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  92%|█████████▎| 925/1000 [00:35<00:02, 27.43it/s]
Training Latent Green:  92%|█████████▎| 925/1000 [00:35<00:02, 27.43it/s]
Training Latent Green:  93%|█████████▎| 926/1000 [00:35<00:02, 24.95it/s]
Training Latent Green:  93%|█████████▎| 930/1000 [00:35<00:02, 26.46it/s]
Training Latent Green:  93%|█████████▎| 934/1000 [00:35<00:02, 27.72it/s]
Training Latent Green:  94%|█████████▎| 937/1000 [00:35<00:02, 27.46it/s]
Training Latent Green:  94%|█████████▍| 940/1000 [00:35<00:02, 27.99it/s]
Training Latent Green:  94%|█████████▍| 943/1000 [00:35<00:02, 28.16it/s]
Training Latent Green:  95%|█████████▍| 946/1000 [00:35<00:01, 27.57it/s]
Training Latent Green:  95%|█████████▍| 949/1000 [00:35<00:01, 28.09it/s]
                                                                         
Step 950: dom line | loss 1.1344 | data 0.5273 | fft 0.7233 | rel 0.8027 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.2572 | data_avg 0.7148 | rel_avg 1.0547 | lr 1.06e-05 | gn 1.000 | it/s 27.30 | s/s 109 | stats 0.0984 | psd 1.4465 | ms 0.2160 | res 0.0476 | sum 0.9491 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  95%|█████████▌| 950/1000 [00:36<00:01, 28.09it/s]
Training Latent Green:  95%|█████████▌| 950/1000 [00:36<00:01, 28.09it/s]
Training Latent Green:  95%|█████████▌| 952/1000 [00:36<00:01, 28.07it/s]
Training Latent Green:  96%|█████████▌| 956/1000 [00:36<00:01, 28.63it/s]
Training Latent Green:  96%|█████████▌| 959/1000 [00:36<00:01, 28.63it/s]
Training Latent Green:  96%|█████████▌| 962/1000 [00:36<00:01, 28.44it/s]
Training Latent Green:  96%|█████████▋| 965/1000 [00:36<00:01, 28.42it/s]
Training Latent Green:  97%|█████████▋| 968/1000 [00:36<00:01, 28.73it/s]
Training Latent Green:  97%|█████████▋| 971/1000 [00:36<00:01, 28.49it/s]
Training Latent Green:  98%|█████████▊| 975/1000 [00:36<00:00, 29.19it/s]
                                                                         
Step 975: dom line | loss 1.1667 | data 0.5343 | fft 0.7210 | rel 0.8125 | loss_n 0.000009 | data_n 0.000004 | loss_avg 2.2300 | data_avg 0.7103 | rel_avg 1.0486 | lr 1.01e-05 | gn 1.000 | it/s 28.99 | s/s 116 | stats 0.0895 | psd 1.4420 | ms 0.2181 | res 0.0692 | sum 0.9493 | ract 1.000 | t 2.700 | tstd 0.000

Training Latent Green:  98%|█████████▊| 975/1000 [00:36<00:00, 29.19it/s]
Training Latent Green:  98%|█████████▊| 975/1000 [00:36<00:00, 29.19it/s]
Training Latent Green:  98%|█████████▊| 978/1000 [00:36<00:00, 28.39it/s]
Training Latent Green:  98%|█████████▊| 981/1000 [00:37<00:00, 28.82it/s]
Training Latent Green:  98%|█████████▊| 984/1000 [00:37<00:00, 29.11it/s]
Training Latent Green:  99%|█████████▉| 988/1000 [00:37<00:00, 29.65it/s]
Training Latent Green:  99%|█████████▉| 991/1000 [00:37<00:00, 29.53it/s]
Training Latent Green:  99%|█████████▉| 994/1000 [00:37<00:00, 28.59it/s]
Training Latent Green: 100%|█████████▉| 997/1000 [00:37<00:00, 28.84it/s]
Training Latent Green: 100%|██████████| 1000/1000 [00:37<00:00, 24.43it/s]
Training Latent Green: 100%|██████████| 1000/1000 [00:37<00:00, 26.47it/s]
Loading config from: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/config.yaml
Warning: dataset_root might not be linear/clean: /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke
Searching for checkpoints. Current: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints, Root: /root/data1/GreenDiff/gd/runs
Loading Latent Green from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/latent_green_step_1000.pt
Loading VAE from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/vae_step_500.pt
Using cached shards for val: 2 shards, 100 samples from /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke

Starting Linear Evaluation...

  0%|          | 0/25 [00:00<?, ?it/s]
  0%|          | 0/25 [00:00<?, ?it/s, Rel=0.6571, PeakR=6.1004]
  4%|▍         | 1/25 [00:00<00:03,  6.47it/s, Rel=0.6571, PeakR=6.1004]
  4%|▍         | 1/25 [00:00<00:03,  6.47it/s, Rel=0.6606, PeakR=6.5351]
  4%|▍         | 1/25 [00:00<00:03,  6.47it/s, Rel=0.6566, PeakR=6.3479]
  4%|▍         | 1/25 [00:00<00:03,  6.47it/s, Rel=0.6565, PeakR=6.0313]
  4%|▍         | 1/25 [00:00<00:03,  6.47it/s, Rel=0.6579, PeakR=6.3932]
  4%|▍         | 1/25 [00:00<00:03,  6.47it/s, Rel=0.6524, PeakR=5.6301]
 24%|██▍       | 6/25 [00:00<00:00, 21.50it/s, Rel=0.6524, PeakR=5.6301]
 24%|██▍       | 6/25 [00:00<00:00, 21.50it/s, Rel=0.6603, PeakR=6.5000]
 24%|██▍       | 6/25 [00:00<00:00, 21.50it/s, Rel=0.6654, PeakR=6.7767]
 24%|██▍       | 6/25 [00:00<00:00, 21.50it/s, Rel=0.6581, PeakR=6.4973]
 36%|███▌      | 9/25 [00:00<00:00, 23.99it/s, Rel=0.6581, PeakR=6.4973]
 36%|███▌      | 9/25 [00:00<00:00, 23.99it/s, Rel=0.6557, PeakR=6.0592]
 36%|███▌      | 9/25 [00:00<00:00, 23.99it/s, Rel=0.6566, PeakR=6.3137]
 36%|███▌      | 9/25 [00:00<00:00, 23.99it/s, Rel=0.6540, PeakR=5.6168]
 48%|████▊     | 12/25 [00:00<00:00, 25.28it/s, Rel=0.6540, PeakR=5.6168]
 48%|████▊     | 12/25 [00:00<00:00, 25.28it/s, Rel=0.6599, PeakR=6.3380]
 48%|████▊     | 12/25 [00:00<00:00, 25.28it/s, Rel=0.6577, PeakR=6.1404]
 48%|████▊     | 12/25 [00:00<00:00, 25.28it/s, Rel=0.6572, PeakR=5.8785]
 48%|████▊     | 12/25 [00:00<00:00, 25.28it/s, Rel=0.6572, PeakR=6.0188]
 48%|████▊     | 12/25 [00:00<00:00, 25.28it/s, Rel=0.6592, PeakR=6.4097]
 68%|██████▊   | 17/25 [00:00<00:00, 25.84it/s, Rel=0.6592, PeakR=6.4097]
 68%|██████▊   | 17/25 [00:00<00:00, 25.84it/s, Rel=0.6554, PeakR=6.0145]
 68%|██████▊   | 17/25 [00:00<00:00, 25.84it/s, Rel=0.6566, PeakR=6.2610]
 68%|██████▊   | 17/25 [00:00<00:00, 25.84it/s, Rel=0.6621, PeakR=6.3625]
 80%|████████  | 20/25 [00:00<00:00, 25.86it/s, Rel=0.6621, PeakR=6.3625]
 80%|████████  | 20/25 [00:00<00:00, 25.86it/s, Rel=0.6561, PeakR=6.3627]
 80%|████████  | 20/25 [00:00<00:00, 25.86it/s, Rel=0.6531, PeakR=5.8338]
 80%|████████  | 20/25 [00:00<00:00, 25.86it/s, Rel=0.6590, PeakR=6.4795]
 92%|█████████▏| 23/25 [00:00<00:00, 25.77it/s, Rel=0.6590, PeakR=6.4795]
 92%|█████████▏| 23/25 [00:01<00:00, 25.77it/s, Rel=0.6569, PeakR=6.4920]
 92%|█████████▏| 23/25 [00:01<00:00, 25.77it/s, Rel=0.6598, PeakR=6.3895]
100%|██████████| 25/25 [00:01<00:00, 24.57it/s, Rel=0.6598, PeakR=6.3895]

============================================================
Linear Evaluation Results
============================================================
MSE (Linear)                  : 4.86e-03 卤 1.06e-04
MAE (Linear)                  : 4.97e-02 卤 7.49e-04
Rel L2 (Linear)               : 0.6577 卤 0.0027
------------------------------------------------------------
Peak Error                    : 1.62e+00 卤 2.68e-02
Peak Ratio (Pred/Obs)         : 6.2313 卤 0.2843
Mean Ratio (Pred/Obs)         : 0.9553 卤 0.0233
------------------------------------------------------------
Avg Pred Max: 1.93e+00
Avg Obs Max:  3.12e-01
Avg Pred Mean: 8.52e-02
Avg Obs Mean:  8.94e-02
============================================================

==================================================
Running Stage 3: Diffusion Training
==================================================
Starting Latent Diffusion training...
Using cached shards for train: 29 shards, 1800 samples from /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke
Searching for checkpoints. Current: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints, Root: /root/data1/GreenDiff/gd/runs
Loading VAE from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/vae_step_500.pt
Loading Latent Green from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/latent_green_step_1000.pt
Starting Diffusion training from scratch...
[stats] step=0 bs=4 loss=1.051769 lr=1.00e-05 x0_raw=31.477962 x0_w=0.809347 phys=11760533504.000000 const=12234294272.000000 phys_w=0.0000
[avg] loss=1.051769 x0_raw=31.477962 phys=11760533504.000000 const=12234294272.000000 phys_w=0.0000
[stats] z=-0.0675/1.9162 snr=0.45/0.01/1.58 w=1.000
[stats] step=50 bs=4 loss=1.006446 lr=2.55e-05 x0_raw=1.967729 x0_w=0.574185 phys=81090824.000000 const=91109264.000000 phys_w=0.0000
[avg] loss=1.011702 x0_raw=3.112833 phys=81090824.000000 const=91109264.000000 phys_w=0.0000
[stats] z=-0.0685/1.9133 snr=0.86/0.24/1.46 w=1.000
[stats] step=100 bs=4 loss=0.941587 lr=5.05e-05 x0_raw=1.246999 x0_w=0.398986 phys=56989104.000000 const=56943848.000000 phys_w=0.0000
[avg] loss=0.937264 x0_raw=12.080550 phys=56989104.000000 const=56943848.000000 phys_w=0.0000
[stats] z=-0.0688/1.8825 snr=2.91/0.32/7.19 w=1.000
[stats] step=150 bs=4 loss=0.642552 lr=7.55e-05 x0_raw=3.003782 x0_w=0.269105 phys=214118240.000000 const=233029344.000000 phys_w=0.0000
[avg] loss=0.653505 x0_raw=103.565416 phys=214118240.000000 const=233029344.000000 phys_w=0.0000
[stats] z=-0.0598/1.9440 snr=3.52/0.05/10.88 w=1.000
[stats] step=200 bs=4 loss=0.110110 lr=1.00e-04 x0_raw=0.469619 x0_w=0.049665 phys=28716808.000000 const=18008352.000000 phys_w=0.0000
[avg] loss=0.117344 x0_raw=0.602220 phys=28716808.000000 const=18008352.000000 phys_w=0.0000
[stats] z=-0.0592/1.9342 snr=1.39/0.05/4.64 w=1.000
[stats] step=250 bs=4 loss=0.156655 lr=9.98e-05 x0_raw=0.261284 x0_w=0.069457 phys=26618024.000000 const=12966249.000000 phys_w=0.0000
[avg] loss=0.149513 x0_raw=1.492099 phys=26618024.000000 const=12966249.000000 phys_w=0.0000
[stats] z=-0.0732/1.8380 snr=1.30/0.07/2.56 w=1.000
[stats] step=300 bs=4 loss=0.295265 lr=9.93e-05 x0_raw=0.086035 x0_w=0.039580 phys=24422408.000000 const=9480334.000000 phys_w=0.0000
[avg] loss=0.145523 x0_raw=0.845472 phys=24422408.000000 const=9480334.000000 phys_w=0.0000
[stats] z=-0.0662/1.8927 snr=12.45/0.63/44.71 w=1.000
[stats] step=350 bs=4 loss=0.230354 lr=9.85e-05 x0_raw=1.458545 x0_w=0.023672 phys=77993672.000000 const=82146776.000000 phys_w=0.0000
[avg] loss=0.102544 x0_raw=3.134104 phys=77993672.000000 const=82146776.000000 phys_w=0.0000
[stats] z=-0.0627/1.9285 snr=9.68/0.00/37.71 w=1.000
[stats] step=400 bs=4 loss=0.060012 lr=9.73e-05 x0_raw=0.287824 x0_w=0.040339 phys=26832792.000000 const=13864315.000000 phys_w=0.0000
[avg] loss=0.090851 x0_raw=4.068671 phys=26832792.000000 const=13864315.000000 phys_w=0.0000
[stats] z=-0.0667/1.8666 snr=0.42/0.02/0.89 w=1.000
[stats] step=450 bs=4 loss=0.021088 lr=9.58e-05 x0_raw=0.581083 x0_w=0.017890 phys=34779216.000000 const=26488784.000000 phys_w=0.0000
[avg] loss=0.042091 x0_raw=385.475232 phys=34779216.000000 const=26488784.000000 phys_w=0.0000
[stats] z=-0.0675/1.9162 snr=0.10/0.01/0.33 w=1.000

Step 500: Running validation...
Validation images saved to /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/images/val_step_500.png
[stats] step=500 bs=4 loss=0.096641 lr=9.40e-05 x0_raw=0.137982 x0_w=0.038499 phys=25767720.000000 const=11957860.000000 phys_w=0.0000
[avg] loss=0.082224 x0_raw=0.384355 phys=25767720.000000 const=11957860.000000 phys_w=0.0000
[stats] z=-0.0685/1.9133 snr=1.18/0.04/1.82 w=1.000
[stats] step=550 bs=4 loss=0.096671 lr=9.19e-05 x0_raw=0.134989 x0_w=0.042096 phys=25699794.000000 const=11368818.000000 phys_w=0.0000
[avg] loss=0.085206 x0_raw=0.241075 phys=25699794.000000 const=11368818.000000 phys_w=0.0000
[stats] z=-0.0688/1.8825 snr=0.80/0.06/2.16 w=1.000
[stats] step=600 bs=4 loss=0.043293 lr=8.95e-05 x0_raw=0.071138 x0_w=0.019718 phys=23960064.000000 const=9661110.000000 phys_w=0.0000
[avg] loss=0.118398 x0_raw=4.441208 phys=23960064.000000 const=9661110.000000 phys_w=0.0000
[stats] z=-0.0598/1.9440 snr=1.06/0.12/2.58 w=1.000
[stats] step=650 bs=4 loss=0.071086 lr=8.68e-05 x0_raw=0.078919 x0_w=0.029107 phys=24879916.000000 const=10894776.000000 phys_w=0.0000
[avg] loss=0.047973 x0_raw=0.205350 phys=24879916.000000 const=10894776.000000 phys_w=0.0000
[stats] z=-0.0592/1.9342 snr=0.84/0.08/1.62 w=1.000
[stats] step=700 bs=4 loss=0.300264 lr=8.39e-05 x0_raw=0.102043 x0_w=0.059386 phys=25233426.000000 const=10139872.000000 phys_w=0.0000
[avg] loss=0.093651 x0_raw=0.110436 phys=25233426.000000 const=10139872.000000 phys_w=0.0000
[stats] z=-0.0732/1.8380 snr=25.87/0.81/99.25 w=1.000
[stats] step=750 bs=4 loss=0.014433 lr=8.08e-05 x0_raw=0.636325 x0_w=0.012092 phys=36420308.000000 const=28536168.000000 phys_w=0.0000
[avg] loss=0.085050 x0_raw=0.608913 phys=36420308.000000 const=28536168.000000 phys_w=0.0000
[stats] z=-0.0662/1.8927 snr=0.17/0.01/0.58 w=1.000
[stats] step=800 bs=4 loss=0.031009 lr=7.75e-05 x0_raw=0.187956 x0_w=0.015599 phys=26080354.000000 const=12641266.000000 phys_w=0.0000
[avg] loss=0.042086 x0_raw=0.156341 phys=26080354.000000 const=12641266.000000 phys_w=0.0000
[stats] z=-0.0627/1.9285 snr=1.01/0.03/3.65 w=1.000
[stats] step=850 bs=4 loss=0.058951 lr=7.40e-05 x0_raw=0.155151 x0_w=0.040177 phys=24668104.000000 const=10186792.000000 phys_w=0.0000
[avg] loss=0.089532 x0_raw=27.037759 phys=24668104.000000 const=10186792.000000 phys_w=0.0000
[stats] z=-0.0667/1.8666 snr=0.31/0.14/0.49 w=1.000
[stats] step=900 bs=4 loss=0.037572 lr=7.04e-05 x0_raw=0.151883 x0_w=0.021267 phys=25904516.000000 const=12163355.000000 phys_w=0.0000
[avg] loss=0.055589 x0_raw=0.165138 phys=25904516.000000 const=12163355.000000 phys_w=0.0000
[stats] z=-0.0675/1.9162 snr=0.34/0.03/1.03 w=1.000
[stats] step=950 bs=4 loss=0.036030 lr=6.66e-05 x0_raw=0.108466 x0_w=0.023482 phys=25111212.000000 const=10721248.000000 phys_w=0.0000
[avg] loss=0.073668 x0_raw=0.158313 phys=25111212.000000 const=10721248.000000 phys_w=0.0000
[stats] z=-0.0685/1.9133 snr=0.31/0.08/0.74 w=1.000

Step 1000: Running validation...
Validation images saved to /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/images/val_step_1000.png
[stats] step=1000 bs=4 loss=0.051330 lr=6.28e-05 x0_raw=0.158161 x0_w=0.031904 phys=26118260.000000 const=11829182.000000 phys_w=0.0000
[avg] loss=0.063099 x0_raw=0.342212 phys=26118260.000000 const=11829182.000000 phys_w=0.0000
[stats] z=-0.0688/1.8825 snr=0.31/0.03/0.83 w=1.000
[stats] step=1050 bs=4 loss=0.110960 lr=5.89e-05 x0_raw=0.080783 x0_w=0.013426 phys=24624964.000000 const=10611909.000000 phys_w=0.0000
[avg] loss=0.171608 x0_raw=0.068124 phys=24624964.000000 const=10611909.000000 phys_w=0.0000
[stats] z=-0.0598/1.9440 snr=12.78/0.07/49.25 w=1.000
[stats] step=1100 bs=4 loss=0.025723 lr=5.50e-05 x0_raw=0.100544 x0_w=0.014454 phys=24472064.000000 const=10166219.000000 phys_w=0.0000
[avg] loss=0.109391 x0_raw=1.195597 phys=24472064.000000 const=10166219.000000 phys_w=0.0000
[stats] z=-0.0592/1.9342 snr=0.61/0.09/2.02 w=1.000
[stats] step=1150 bs=4 loss=0.035723 lr=5.11e-05 x0_raw=0.389778 x0_w=0.017400 phys=29959436.000000 const=18563730.000000 phys_w=0.0000
[avg] loss=0.047611 x0_raw=2.927914 phys=29959436.000000 const=18563730.000000 phys_w=0.0000
[stats] z=-0.0732/1.8380 snr=0.92/0.01/3.27 w=1.000
[stats] step=1200 bs=4 loss=0.073401 lr=4.72e-05 x0_raw=0.161238 x0_w=0.020847 phys=26225730.000000 const=12613238.000000 phys_w=0.0000
[avg] loss=0.062379 x0_raw=0.173574 phys=26225730.000000 const=12613238.000000 phys_w=0.0000
[stats] z=-0.0662/1.8927 snr=2.28/0.02/4.64 w=1.000
[stats] step=1250 bs=4 loss=0.010623 lr=4.34e-05 x0_raw=0.154453 x0_w=0.009198 phys=26285372.000000 const=13090780.000000 phys_w=0.0000
[avg] loss=0.071960 x0_raw=0.473586 phys=26285372.000000 const=13090780.000000 phys_w=0.0000
[stats] z=-0.0627/1.9285 snr=0.12/0.03/0.27 w=1.000
[stats] step=1300 bs=4 loss=0.208326 lr=3.96e-05 x0_raw=0.213748 x0_w=0.048673 phys=27160956.000000 const=14357201.000000 phys_w=0.0000
[avg] loss=0.091131 x0_raw=0.466679 phys=27160956.000000 const=14357201.000000 phys_w=0.0000
[stats] z=-0.0667/1.8666 snr=2.59/0.01/6.61 w=1.000
[stats] step=1350 bs=4 loss=0.059734 lr=3.60e-05 x0_raw=1.511963 x0_w=0.023130 phys=91767048.000000 const=95489944.000000 phys_w=0.0000
[avg] loss=0.101359 x0_raw=0.417030 phys=91767048.000000 const=95489944.000000 phys_w=0.0000
[stats] z=-0.0675/1.9162 snr=0.77/0.00/2.42 w=1.000
[stats] step=1400 bs=4 loss=0.019884 lr=3.25e-05 x0_raw=5.246347 x0_w=0.014566 phys=627877888.000000 const=681344256.000000 phys_w=0.0000
[avg] loss=0.050092 x0_raw=1.197499 phys=627877888.000000 const=681344256.000000 phys_w=0.0000
[stats] z=-0.0685/1.9133 snr=0.30/0.00/0.92 w=1.000
[stats] step=1450 bs=4 loss=0.321885 lr=2.92e-05 x0_raw=0.037888 x0_w=0.021088 phys=25024444.000000 const=10243740.000000 phys_w=0.0000
[avg] loss=0.134628 x0_raw=0.287328 phys=25024444.000000 const=10243740.000000 phys_w=0.0000
[stats] z=-0.0688/1.8825 snr=10.58/0.21/24.25 w=1.000

Step 1500: Running validation...
Validation images saved to /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/images/val_step_1500.png
[stats] step=1500 bs=4 loss=0.034767 lr=2.61e-05 x0_raw=0.070021 x0_w=0.013227 phys=24623560.000000 const=10587835.000000 phys_w=0.0000
[avg] loss=0.053056 x0_raw=0.196392 phys=24623560.000000 const=10587835.000000 phys_w=0.0000
[stats] z=-0.0598/1.9440 snr=0.65/0.05/2.23 w=1.000
[stats] step=1550 bs=4 loss=0.016225 lr=2.32e-05 x0_raw=0.083948 x0_w=0.011065 phys=24634050.000000 const=10370572.000000 phys_w=0.0000
[avg] loss=0.097689 x0_raw=0.101093 phys=24634050.000000 const=10370572.000000 phys_w=0.0000
[stats] z=-0.0592/1.9342 snr=0.63/0.11/1.74 w=1.000
[stats] step=1600 bs=4 loss=0.130610 lr=2.05e-05 x0_raw=0.119329 x0_w=0.040075 phys=25531646.000000 const=10582406.000000 phys_w=0.0000
[avg] loss=0.055834 x0_raw=0.439436 phys=25531646.000000 const=10582406.000000 phys_w=0.0000
[stats] z=-0.0732/1.8380 snr=1.06/0.13/3.40 w=1.000
[stats] step=1650 bs=4 loss=0.009068 lr=1.81e-05 x0_raw=74.303543 x0_w=0.008206 phys=127021547520.000000 const=136431026176.000000 phys_w=0.0000
[avg] loss=0.061388 x0_raw=16.827558 phys=127021547520.000000 const=136431026176.000000 phys_w=0.0000
[stats] z=-0.0662/1.8927 snr=0.07/0.00/0.11 w=1.000
[stats] step=1700 bs=4 loss=0.262248 lr=1.60e-05 x0_raw=0.082764 x0_w=0.014214 phys=25784106.000000 const=12172571.000000 phys_w=0.0000
[avg] loss=0.134688 x0_raw=403.011177 phys=25784106.000000 const=12172571.000000 phys_w=0.0000
[stats] z=-0.0627/1.9285 snr=31.92/0.01/124.25 w=1.000
[stats] step=1750 bs=4 loss=0.026429 lr=1.42e-05 x0_raw=0.201799 x0_w=0.016373 phys=26777796.000000 const=13422114.000000 phys_w=0.0000
[avg] loss=0.047004 x0_raw=0.394954 phys=26777796.000000 const=13422114.000000 phys_w=0.0000
[stats] z=-0.0667/1.8666 snr=0.40/0.02/1.43 w=1.000
[stats] step=1800 bs=4 loss=0.199640 lr=1.27e-05 x0_raw=0.281065 x0_w=0.013624 phys=30801112.000000 const=19718840.000000 phys_w=0.0000
[avg] loss=0.131919 x0_raw=1.842504 phys=30801112.000000 const=19718840.000000 phys_w=0.0000
[stats] z=-0.0675/1.9162 snr=11.90/0.00/40.92 w=1.000
[stats] step=1850 bs=4 loss=0.034058 lr=1.15e-05 x0_raw=0.240401 x0_w=0.019677 phys=28984820.000000 const=16881548.000000 phys_w=0.0000
[avg] loss=0.063746 x0_raw=0.144694 phys=28984820.000000 const=16881548.000000 phys_w=0.0000
[stats] z=-0.0685/1.9133 snr=0.34/0.01/1.06 w=1.000
[stats] step=1900 bs=4 loss=0.115503 lr=1.07e-05 x0_raw=0.706037 x0_w=0.035365 phys=42980032.000000 const=36099776.000000 phys_w=0.0000
[avg] loss=0.064830 x0_raw=0.709019 phys=42980032.000000 const=36099776.000000 phys_w=0.0000
[stats] z=-0.0688/1.8825 snr=2.17/0.00/4.53 w=1.000
[stats] step=1950 bs=4 loss=0.024096 lr=1.02e-05 x0_raw=0.058061 x0_w=0.015135 phys=24363164.000000 const=10092462.000000 phys_w=0.0000
[avg] loss=0.070308 x0_raw=0.234268 phys=24363164.000000 const=10092462.000000 phys_w=0.0000
[stats] z=-0.0598/1.9440 snr=0.34/0.12/0.78 w=1.000

Step 2000: Running validation...
Validation images saved to /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/images/val_step_2000.png

==================================================
Running Stage 4: Student Training
==================================================
Using cached shards for train: 29 shards, 1800 samples from /root/data1/GreenDiff/gd/data_cache_vonly_cuda_smoke
Searching for checkpoints. Current: /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints, Root: /root/data1/GreenDiff/gd/runs
Loading Teacher Diffusion from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/diffusion_step_2000.pt
Loading VAE from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/vae_step_500.pt
Loading Latent Green from /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02/checkpoints/latent_green_step_1000.pt
Starting Student training from scratch...

Training Student:   0%|          | 0/50 [00:00<?, ?it/s]
Training Student:   0%|          | 0/50 [00:00<?, ?it/s, loss=3890.100586, imitation=3890.100586]
Training Student:   2%|▏         | 1/50 [00:00<00:36,  1.35it/s, loss=3890.100586, imitation=3890.100586]
Training Student:   4%|▍         | 2/50 [00:00<00:21,  2.26it/s, loss=3890.100586, imitation=3890.100586]
Training Student:   6%|▌         | 3/50 [00:01<00:19,  2.40it/s, loss=3890.100586, imitation=3890.100586]
Training Student:   8%|▊         | 4/50 [00:01<00:17,  2.64it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  10%|█         | 5/50 [00:02<00:17,  2.63it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  12%|█▏        | 6/50 [00:02<00:15,  2.81it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  14%|█▍        | 7/50 [00:02<00:15,  2.72it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  16%|█▌        | 8/50 [00:03<00:14,  2.87it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  18%|█▊        | 9/50 [00:03<00:14,  2.76it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  20%|██        | 10/50 [00:03<00:13,  2.87it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  22%|██▏       | 11/50 [00:04<00:13,  2.79it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  24%|██▍       | 12/50 [00:04<00:14,  2.70it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  26%|██▌       | 13/50 [00:04<00:13,  2.84it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  28%|██▊       | 14/50 [00:05<00:13,  2.74it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  30%|███       | 15/50 [00:05<00:13,  2.65it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  32%|███▏      | 16/50 [00:05<00:12,  2.80it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  34%|███▍      | 17/50 [00:06<00:12,  2.71it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  36%|███▌      | 18/50 [00:06<00:11,  2.86it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  38%|███▊      | 19/50 [00:07<00:11,  2.77it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  40%|████      | 20/50 [00:07<00:11,  2.70it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  42%|████▏     | 21/50 [00:07<00:10,  2.65it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  44%|████▍     | 22/50 [00:08<00:10,  2.77it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  46%|████▌     | 23/50 [00:08<00:09,  2.72it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  48%|████▊     | 24/50 [00:08<00:09,  2.65it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  50%|█████     | 25/50 [00:09<00:09,  2.57it/s, loss=3890.100586, imitation=3890.100586]
Training Student:  50%|█████     | 25/50 [00:09<00:09,  2.57it/s, loss=611.091736, imitation=611.091736]  
Training Student:  52%|█████▏    | 26/50 [00:09<00:09,  2.57it/s, loss=611.091736, imitation=611.091736]
Training Student:  54%|█████▍    | 27/50 [00:10<00:08,  2.56it/s, loss=611.091736, imitation=611.091736]
Training Student:  56%|█████▌    | 28/50 [00:10<00:08,  2.54it/s, loss=611.091736, imitation=611.091736]
Training Student:  58%|█████▊    | 29/50 [00:10<00:07,  2.72it/s, loss=611.091736, imitation=611.091736]
Training Student:  60%|██████    | 30/50 [00:11<00:07,  2.65it/s, loss=611.091736, imitation=611.091736]
Training Student:  62%|██████▏   | 31/50 [00:11<00:06,  2.84it/s, loss=611.091736, imitation=611.091736]
Training Student:  64%|██████▍   | 32/50 [00:11<00:06,  2.73it/s, loss=611.091736, imitation=611.091736]
Training Student:  66%|██████▌   | 33/50 [00:12<00:05,  2.87it/s, loss=611.091736, imitation=611.091736]
Training Student:  68%|██████▊   | 34/50 [00:12<00:05,  2.76it/s, loss=611.091736, imitation=611.091736]
Training Student:  70%|███████   | 35/50 [00:12<00:05,  2.89it/s, loss=611.091736, imitation=611.091736]
Training Student:  72%|███████▏  | 36/50 [00:13<00:05,  2.78it/s, loss=611.091736, imitation=611.091736]
Training Student:  74%|███████▍  | 37/50 [00:13<00:04,  2.69it/s, loss=611.091736, imitation=611.091736]
Training Student:  76%|███████▌  | 38/50 [00:14<00:04,  2.81it/s, loss=611.091736, imitation=611.091736]
Training Student:  78%|███████▊  | 39/50 [00:14<00:04,  2.74it/s, loss=611.091736, imitation=611.091736]
Training Student:  80%|████████  | 40/50 [00:14<00:03,  2.67it/s, loss=611.091736, imitation=611.091736]
Training Student:  82%|████████▏ | 41/50 [00:15<00:03,  2.80it/s, loss=611.091736, imitation=611.091736]
Training Student:  84%|████████▍ | 42/50 [00:15<00:02,  2.73it/s, loss=611.091736, imitation=611.091736]
Training Student:  86%|████████▌ | 43/50 [00:15<00:02,  2.66it/s, loss=611.091736, imitation=611.091736]
Training Student:  88%|████████▊ | 44/50 [00:16<00:02,  2.61it/s, loss=611.091736, imitation=611.091736]
Training Student:  90%|█████████ | 45/50 [00:16<00:01,  2.77it/s, loss=611.091736, imitation=611.091736]
Training Student:  92%|█████████▏| 46/50 [00:17<00:01,  2.70it/s, loss=611.091736, imitation=611.091736]
Training Student:  94%|█████████▍| 47/50 [00:17<00:01,  2.83it/s, loss=611.091736, imitation=611.091736]
Training Student:  96%|█████████▌| 48/50 [00:17<00:00,  2.74it/s, loss=611.091736, imitation=611.091736]
Training Student:  98%|█████████▊| 49/50 [00:18<00:00,  2.94it/s, loss=611.091736, imitation=611.091736]
Training Student: 100%|██████████| 50/50 [00:18<00:00,  3.00it/s, loss=611.091736, imitation=611.091736]
Training Student: 100%|██████████| 50/50 [00:18<00:00,  2.72it/s, loss=611.091736, imitation=611.091736]

Pipeline completed successfully! Results saved to /root/data1/GreenDiff/gd/runs/2026-02-26_16-36-02
